VSL version 1.01

(begin)
REDUCE 2 (AUG-10-73) ...
FOR HELP, TYPE HELP<ALTMODE>


comment some examples of the  f o r  statement;

comment summing the squares of the even positive integers
      through 50;

for i:=2 step 2 until 50 sum i**2;

22100


comment to set  xxx  to the factorial of 10;

xxx:=for i:=1:10 product i;

xxx := 3628800


comment alternatively, we could set the elements a(i) of the
      array  a  to the factorial of i by the statements;

array a(10);


a(0):=1$


for i:=1:10 do a(i):=i*a(i-1);


comment the above version of the f o r statement does not return an
      algebraic value, but we can now use these array elements
      as factorials in expressions, e. g.;

1+a(5);

121


comment we could have printed the values of each a(i)
      as they were computed by replacing the f o r statement by;

for i:=1:10 do write a(i):=i*a(i-1);

a(1) := 1

a(2) := 2

a(3) := 6

a(4) := 24

a(5) := 120

a(6) := 720

a(7) := 5040

a(8) := 40320

a(9) := 362880

a(10) := 3628800


comment another way to use factorials would be to introduce an
operator  fac  by an integer procedure as follows;

integer procedure fac(n);
begin integer m,n;
m:=1;
l1:if n=0 then return m;
m:=m*n;
n:=n-1;
go to l1 end;


comment we can now use  fac  as an operator in expressions,
e. g. ;

z**2+fac(4)-2*fac 2*y;

          2
 - 4*y + z  + 24


comment note in the above example that the parentheses around
the arguments of  fac  may be omitted since  fac  is a unary operator;

comment the following examples illustrate the solution of some
      complete problems;

comment the f and g series (ref  sconzo, p., leschack, a. r. and
         tobey, r. g., astronomical journal, vol 70 (may 1965);

scalar f1,f2,g1,g2;


deps:=-sig*(mu+2*eps)$


dmu:=-3*mu*sig$


dsig:=eps-2*sig**2$


f1:=1$


g1:=0$


for i:=1:8 do begin f2:=-mu*g1+deps*df(f1,eps)+dmu*df(f1,mu)+dsig*df(f1,sig)$
write f(,i, ) := ,f2;
g2:=f1+deps*df(g1,eps)+dmu*df(g1,mu)+dsig*df(g1,sig)$
write g(,i, ) := ,g2;
f1:=f2$
g1:=g2 end;

f(1) := 0

g(1) := 1

f(2) :=  - mu

g(2) := 0

f(3) := 3*mu*sig

g(3) :=  - mu

                               2
f(4) := mu*(3*eps + mu - 15*sig )

g(4) := 6*mu*sig

                                        2
f(5) := 15*mu*sig*( - 3*eps - mu + 7*sig )

                               2
g(5) := mu*(9*eps + mu - 45*sig )

                     2                          2     2
f(6) := mu*( - 45*eps  - 24*eps*mu + 630*eps*sig  - mu  + 210*mu*

               2          4
            sig  - 945*sig )

                                         2
g(6) := 30*mu*sig*( - 6*eps - mu + 14*sig )

                         2                          2     2
f(7) := 63*mu*sig*(25*eps  + 14*eps*mu - 150*eps*sig  + mu  - 50*mu

            2          4
        *sig  + 165*sig )

                      2                           2     2
g(7) := mu*( - 225*eps  - 54*eps*mu + 3150*eps*sig  - mu  + 630*mu*

               2           4
            sig  - 4725*sig )

                    3           2               2    2
f(8) := mu*(1575*eps  + 1107*eps *mu - 42525*eps *sig  + 117*eps*mu

            2                   2                 4     3
              - 24570*eps*mu*sig  + 155925*eps*sig  + mu  - 2205*mu

            2    2               4             6
             *sig  + 51975*mu*sig  - 135135*sig )

                          2                          2     2
g(8) := 126*mu*sig*(75*eps  + 24*eps*mu - 450*eps*sig  + mu  - 100*

              2          4
        mu*sig  + 495*sig )


comment a problem in fourier analysis;

for all x,y let cos(x)*cos(y)=(cos(x+y)+cos(x-y))/2,cos(x)*sin(y)=(sin(x+y)-sin
(x-y))/2,sin(x)*sin(y)=(cos(x-y)-cos(x+y))/2;


factor cos,sin;


on list;


(a1*cos(wt)+a3*cos(3*wt)+b1*sin(wt)+b3*sin(3*wt))**3;

          3   3
(4*cos(wt) *a1

                 2
  + 3*cos(wt)*(a1 *a3

           2
  + 2*a1*a3

         2
  + a1*b1

  + 2*a1*b1*b3

           2
  + 2*a1*b3

         2
  - a3*b1 )

                     2
  - 3*cos(9*wt)*a3*b3

                      2
  + 3*cos(7*wt)*(a1*a3

         2
  - a1*b3

  - 2*a3*b1*b3)

                   2
  + 3*cos(5*wt)*(a1 *a3

         2
  + a1*a3

  - 2*a1*b1*b3

         2
  - a1*b3

         2
  - a3*b1

  + 2*a3*b1*b3)

               3   3
  + 4*cos(3*wt) *a3

                     2
  + 3*cos(3*wt)*(2*a1 *a3

         2
  - a1*b1

           2
  + 2*a3*b1

         2
  + a3*b3 )

             3   3
  + 4*sin(wt) *b1

                 2
  + 3*sin(wt)*(a1 *b1

      2
  + a1 *b3

  - 2*a1*a3*b1

        2
  + 2*a3 *b1

      2
  - b1 *b3

           2
  + 2*b1*b3 )

                  2
  + 3*sin(9*wt)*a3 *b3

  + 3*sin(7*wt)*(2*a1*a3*b3

      2
  + a3 *b1

         2
  - b1*b3 )

                   2
  + 3*sin(5*wt)*(a1 *b3

  + 2*a1*a3*b1

  + 2*a1*a3*b3

      2
  - a3 *b1

      2
  - b1 *b3

         2
  + b1*b3 )

               3   3
  + 4*sin(3*wt) *b3

                   2
  + 3*sin(3*wt)*(a1 *b1

        2
  + 2*a1 *b3

      2
  + a3 *b3

        2
  + 2*b1 *b3))/4


comment end of fourier analysis example ;

off list;


for all x,y clear cos x*cos y,cos x*sin y,sin x*sin y;


comment leaving such replacements active would slow down
        subsequent computation;

comment an example using the matrix facility;

matrix xx,yy;


let xx=mat((a11,a12),(a21,a22)),yy=mat((y1),(y2));


2*det xx-3*xxx;

2*(a11*a22 - a12*a21 - 5443200)


comment @@@@@ zz:= solve (xx,yy);

1/xx**2;

                          2      2    2                          2
mat(1,1) := (a12*a21 + a22 )/(a11 *a22  - 2*a11*a12*a21*a22 + a12 *

               2
            a21 )

                                     2    2
mat(1,2) := ( - a12*(a11 + a22))/(a11 *a22  - 2*a11*a12*a21*a22 + 

               2    2
            a12 *a21 )

                                     2    2
mat(2,1) := ( - a21*(a11 + a22))/(a11 *a22  - 2*a11*a12*a21*a22 + 

               2    2
            a12 *a21 )

                2                2    2                          2
mat(2,2) := (a11  + a12*a21)/(a11 *a22  - 2*a11*a12*a21*a22 + a12 *

               2
            a21 )



comment end of matrix examples;

comment the following examples will fail unless the functions
        needed for problems in high energy physics have been loaded;

comment a physics example;

on div;


comment this gives us output in same form as bjorken and drell;

mass ki=0,kf=0,pi=m,pf=m;


vector ei,ef;


mshell ki,kf,pi,pf;


let pi.ei=0,pi.ef=0,pi.pf=m**2+ki.kf,pi.ki=m*k,pi.kf=m*kp,pf.ei=-kf.ei,pf.ef=ki
.ef,pf.ki=m*kp,pf.kf=m*k,ki.ei=0,ki.kf=m*(k-kp),kf.ef=0,ei.ei=-1,ef.ef=-1;


for all p let gp(p)=g(l,p)+m;


comment this is just to save us a lot of writing;

gp(pf)*(g(l,ef,ei,ki)/(2*ki.pi)+g(l,ei,ef,kf)/(2*kf.pi))*gp(pi)*(g(l,ki,ei,ef)/
(2*ki.pi)+g(l,kf,ef,ei)/(2*kf.pi))$


write the compton cross-section is ,*ans;

                                     (-1)        (-1)             2
the compton cross-section is 1/2*k*kp     + 1/2*k    *kp + 2*ef.ei

 - 1


comment end of first physics example;

off div;


comment another physics example;

factor mm,p1.p3;
(p1 declared vector)
(p3 declared vector)


index x1,y1,z;


mass p1=mm,p2=mm,p3=mm,p4=mm,k1=0;


mshell p1,p2,p3,p4,k1;


vector q1,q2;


for all p let ga(p)=g(la,p)+mm,gb(p)=g(lb,p)+mm;


ga(-p2)*g(la,x1)*ga(-p4)*g(la,y1)*(gb(p3)*g(lb,x1)*gb(q1)*g(lb,z)*gb(p1)*g(lb,
y1)*gb(q2)*g(lb,z)+gb(p3)*g(lb,z)*gb(q2)*g(lb,x1)*gb(p1)*g(lb,z)*gb(q1)*g(lb,y1
))$


let q1=p1-k1,q2=p3+k1;


comment it is usually faster to make such substitutions after all
        trace algebra is done;

write cxn = ,*ans;

           4             4                        2      2        2
cxn = 32*mm *p1.p3 + 8*mm *(k1.p1 - k1.p3) - 16*mm *p1.p3  + 16*mm

                                              2
      *p1.p3*( - k1.p1 + k1.p3 - p2.p4) + 8*mm *( - k1.p1*p2.p4 - 2

      *k1.p2*k1.p4 + k1.p3*p2.p4) + 8*p1.p3*(k1.p2*p1.p4 - k1.p2*p3

      .p4 + k1.p4*p1.p2 - k1.p4*p2.p3 + 2*p1.p2*p3.p4 + 2*p1.p4*p2.

      p3) + 8*(k1.p1*p1.p2*p3.p4 + k1.p1*p1.p4*p2.p3 + 2*k1.p1*p2.

      p3*p3.p4 - 2*k1.p3*p1.p2*p1.p4 - k1.p3*p1.p2*p3.p4 - k1.p3*p1

      .p4*p2.p3)


comment end of second physics example;

comment the following rather long program is a complete routine for
calculating the ricci scalar. it was developed in collaboration with
david barton and john fitch;

comment first we inhibit diagnostic message printing and the printing of
      zero elements of arrays;

off msg$


on nero$


comment here we introduce the covariant and contravariant metrics;

array gg(3,3),h(3,3)$


operator x$


for i:=0:3 do for j:=0:3 do gg(i,j):=h(i,j):=0$


gg(0,0):=e**(q1(x(1)))$


gg(1,1):=-e**(p1(x(1)))$


gg(2,2):=-x(1)**2$


gg(3,3):=-x(1)**2*sin(x(2))**2$


for i:=0:3 do h(i,i):=1/gg(i,i)$


if i uneq j let df(p1(x(i)),x(j))=0,df(q1(x(i)),x(j))=0;


comment generate christoffel symbols and store in arrays
      cs1 and cs2;

array cs1(3,3,3)$


for i:=0:3 do for j:=i:3 do for k:=0:3 do cs1(j,i,k):=cs1(i,j,k):=(df(gg(i,k),x
(j))+df(gg(j,k),x(i))-df(gg(i,j),x(k)))/2$


array cs2(3,3,3)$


for i:=0:3 do for j:=i:3 do for k:=0:3 do cs2(j,i,k):=cs2(i,j,k):=for p:=0:3 
sum h(k,p)*cs1(i,j,p)$


comment now calculate the derivatives of the christoffel symbols
      and store in dc2(i,j,k,l);

array dc2(3,3,3,3)$


for i:=0:3 do for j:=i:3 do for k:=0:3 do for l:=0:3 do dc2(j,i,k,l):=dc2(i,j,k
,l):=df(cs2(i,j,k),x(l))$


comment now store the sums of products of the cs2 in spcs2;

array spcs2(3,3,3,3)$


for i:=0:3 do for j:=i:3 do for k:=0:3 do for l:=0:3 do spcs2(j,i,k,l):=spcs2(i
,j,k,l):=for p:=0:3 sum cs2(p,l,k)*cs2(i,j,p)$
+++ GC number 1 - collection complete (15364 Kbytes free)


comment now compute the riemann tensor and store in r(i,j,k,l);

array r(3,3,3,3)$


for i:=0:3 do for j:=i+1:3 do for k:=i:3 do for l:=k+1:if k=i then j 
else 3 do begin r(j,i,l,k):=r(i,j,k,l):=for q:=0:3 sum gg(i,q)*(dc2(k,j,q,l)-
dc2(j,l,q,k)+spcs2(k,j,q,l)-spcs2(l,j,q,k))$
r(i,j,l,k):=r(j,i,k,l):=-r(i,j,k,l)$
if i=k and j=l then go to a$
r(k,l,i,j):=r(l,k,j,i):=r(i,j,k,l)$
r(l,k,i,j):=r(k,l,j,i):=-r(i,j,k,l)$
a:end$


comment now compute and print the ricci tensor;

array ricci(3,3)$


for i:=0:3 do for j:=0:3 do write ricci(j,i):=ricci(i,j):=for p:=0:3 sum for q:
=0:3 sum h(p,q)*r(q,i,p,j);

                                                  2
ricci(0,0) := ricci(0,0) := (2*cos(x(2))*sin(x(2)) *( - df(q1(x(1))

        p1(x(1))  q1(x(1))                                    q1(x(
,x(2))*e        *e         - df(q1(x(1)),x(1))*df(x(2),x(1))*e

1))     2                                    p1(x(1))     2
   *x(1)  - df(q1(x(1)),x(0))*df(x(2),x(0))*e        *x(1)  + 2*df(

              p1(x(1))     2                                  p1(x(
x(2),x(0),2)*e        *x(1)  + 4*df(x(2),x(0))*df(x(1),x(0))*e

1))                                                      p1(x(1))
   *x(1)) + 2*cos(x(2))*df(q1(x(1)),x(3))*df(x(2),x(3))*e        *e

q1(x(1))            3                                          p1(x
         + sin(x(2)) *( - df(p1(x(1)),x(2))*df(q1(x(1)),x(2))*e

(1))  q1(x(1))                                        q1(x(1))
    *e         + df(p1(x(1)),x(1))*df(q1(x(1)),x(1))*e        *x(1)

2                          p1(x(1))     2                    2  p1(
  + 2*df(p1(x(1)),x(0),2)*e        *x(1)  + df(p1(x(1)),x(0)) *e

x(1))     2                                        p1(x(1))     2
     *x(1)  - df(p1(x(1)),x(0))*df(q1(x(1)),x(0))*e        *x(1)

                          p1(x(1))  q1(x(1))                    2
 - 2*df(q1(x(1)),x(2),2)*e        *e         - df(q1(x(1)),x(2)) *e

p1(x(1))  q1(x(1))                          q1(x(1))     2
        *e         - 2*df(q1(x(1)),x(1),2)*e        *x(1)  - df(q1(

           2  q1(x(1))     2                        q1(x(1))
x(1)),x(1)) *e        *x(1)  - 4*df(q1(x(1)),x(1))*e        *x(1)

                                      p1(x(1))
 - 4*df(q1(x(1)),x(0))*df(x(1),x(0))*e        *x(1) - 4*df(x(2),x(0

  2  p1(x(1))     2                      p1(x(1))
)) *e        *x(1)  + 8*df(x(1),x(0),2)*e        *x(1)) + sin(x(2))

  p1(x(1))  q1(x(1))
*e        *e        *( - df(p1(x(1)),x(3))*df(q1(x(1)),x(3)) - 2*df

                                     2               3  p1(x(1))
(q1(x(1)),x(3),2) - df(q1(x(1)),x(3)) ))/(4*sin(x(2)) *e        *x(

  2
1) )

ricci(1,0) := ricci(0,1) := (cos(x(2))*( - df(p1(x(1)),x(0))*df(x(2

),x(1))*x(1) - df(q1(x(1)),x(1))*df(x(2),x(0))*x(1) + 2*df(x(2),x(1

),x(0))*x(1) + 2*df(x(2),x(1))*df(x(1),x(0)) + 2*df(x(2),x(0))) + 2

*sin(x(2))*( - df(p1(x(1)),x(0)) - df(q1(x(1)),x(1))*df(x(1),x(0))

             - df(x(2),x(1))*df(x(2),x(0))*x(1) + 2*df(x(1),x(1),x(

            0))))/(2*sin(x(2))*x(1))

ricci(2,0) := ricci(0,2) := (2*cos(x(2))*x(1)*( - df(q1(x(1)),x(2))

*df(x(2),x(0))*x(1) + 2*df(x(2),x(2),x(0))*x(1) + 2*df(x(2),x(0))*

                                                         2
df(x(1),x(2))) + sin(x(2))*(2*df(p1(x(1)),x(2),x(0))*x(1)  + df(p1(

                                  2
x(1)),x(2))*df(p1(x(1)),x(0))*x(1)  - 2*df(p1(x(1)),x(2))*df(x(1),x

                                                    2
(0))*x(1) - df(p1(x(1)),x(0))*df(q1(x(1)),x(2))*x(1)  - 2*df(q1(x(1

                                                  2
)),x(2))*df(x(1),x(0))*x(1) - 4*df(x(2),x(0))*x(1)  + 4*df(x(1),x(2

                                                                2
),x(0))*x(1) - 4*df(x(1),x(2))*df(x(1),x(0))))/(4*sin(x(2))*x(1) )

ricci(3,0) := ricci(0,3) := (2*cos(x(2))*df(x(2),x(0))*x(1)*( - df(

p1(x(1)),x(3))*x(1) - 2*df(x(1),x(3))) + sin(x(2))*(2*df(p1(x(1)),x

              2                                           2
(3),x(0))*x(1)  + df(p1(x(1)),x(3))*df(p1(x(1)),x(0))*x(1)  - 2*df(

p1(x(1)),x(3))*df(x(1),x(0))*x(1) - df(p1(x(1)),x(0))*df(q1(x(1)),x

         2
(3))*x(1)  - 2*df(q1(x(1)),x(3))*df(x(1),x(0))*x(1) + 4*df(x(1),x(3

                                                                2
),x(0))*x(1) - 4*df(x(1),x(3))*df(x(1),x(0))))/(4*sin(x(2))*x(1) )

ricci(0,1) := ricci(1,0) := (cos(x(2))*( - df(p1(x(1)),x(0))*df(x(2

),x(1))*x(1) - df(q1(x(1)),x(1))*df(x(2),x(0))*x(1) + 2*df(x(2),x(1

),x(0))*x(1) + 2*df(x(2),x(1))*df(x(1),x(0)) + 2*df(x(2),x(0))) + 2

*sin(x(2))*( - df(p1(x(1)),x(0)) - df(q1(x(1)),x(1))*df(x(1),x(0))

             - df(x(2),x(1))*df(x(2),x(0))*x(1) + 2*df(x(1),x(1),x(

            0))))/(2*sin(x(2))*x(1))

                                                  2
ricci(1,1) := ricci(1,1) := (2*cos(x(2))*sin(x(2)) *(df(p1(x(1)),x(

     p1(x(1))  q1(x(1))                                    q1(x(1))
2))*e        *e         - df(p1(x(1)),x(1))*df(x(2),x(1))*e

     2                                    p1(x(1))     2
*x(1)  - df(p1(x(1)),x(0))*df(x(2),x(0))*e        *x(1)  + 2*df(x(2

           q1(x(1))     2                    q1(x(1))
),x(1),2)*e        *x(1)  + 4*df(x(2),x(1))*e        *x(1)) - 2*cos

                                        p1(x(1))  q1(x(1))
(x(2))*df(p1(x(1)),x(3))*df(x(2),x(3))*e        *e         + sin(x(

   3                         p1(x(1))  q1(x(1))
2)) *(2*df(p1(x(1)),x(2),2)*e        *e         + df(p1(x(1)),x(2))

      2  p1(x(1))  q1(x(1))
       *e        *e         + df(p1(x(1)),x(2))*df(q1(x(1)),x(2))*e

      p1(x(1))  q1(x(1))                                        q1(
              *e         - df(p1(x(1)),x(1))*df(q1(x(1)),x(1))*e

      x(1))     2                        q1(x(1))
           *x(1)  - 4*df(p1(x(1)),x(1))*e        *x(1) - 2*df(p1(x(

                   p1(x(1))     2                    2  p1(x(1))
      1)),x(0),2)*e        *x(1)  - df(p1(x(1)),x(0)) *e        *x(

        2                                        p1(x(1))     2
      1)  + df(p1(x(1)),x(0))*df(q1(x(1)),x(0))*e        *x(1)  - 4

                                        p1(x(1))
      *df(p1(x(1)),x(0))*df(x(1),x(0))*e        *x(1) + 2*df(q1(x(1

                  q1(x(1))     2                    2  q1(x(1))
      )),x(1),2)*e        *x(1)  + df(q1(x(1)),x(1)) *e        *x(1

       2                  2  q1(x(1))     2               p1(x(1))
      )  - 4*df(x(2),x(1)) *e        *x(1) ) + sin(x(2))*e        *

 q1(x(1))                                           2
e        *(2*df(p1(x(1)),x(3),2) + df(p1(x(1)),x(3))  + df(p1(x(1))

                                                  3  q1(x(1))     2
           ,x(3))*df(q1(x(1)),x(3))))/(4*sin(x(2)) *e        *x(1)

)

ricci(2,1) := ricci(1,2) := (2*cos(x(2))*x(1)*( - df(p1(x(1)),x(2))

*df(x(2),x(1))*x(1) + 2*df(x(2),x(2),x(1))*x(1) + 2*df(x(2),x(1))*

df(x(1),x(2))) + sin(x(2))*( - df(p1(x(1)),x(2))*df(q1(x(1)),x(1))*

    2                                                           2
x(1)  - 2*df(p1(x(1)),x(2))*x(1) + 2*df(q1(x(1)),x(2),x(1))*x(1)

                                           2
 + df(q1(x(1)),x(2))*df(q1(x(1)),x(1))*x(1)  - 2*df(q1(x(1)),x(2))*

                           2                                      2
x(1) - 4*df(x(2),x(1))*x(1)  - 4*df(x(1),x(2))))/(4*sin(x(2))*x(1)

)

ricci(3,1) := ricci(1,3) := (2*cos(x(2))*df(x(2),x(1))*x(1)*( - df(

q1(x(1)),x(3))*x(1) - 2*df(x(1),x(3))) + sin(x(2))*( - df(p1(x(1)),

                            2
x(3))*df(q1(x(1)),x(1))*x(1)  - 2*df(p1(x(1)),x(3))*x(1) + 2*df(q1(

                     2                                           2
x(1)),x(3),x(1))*x(1)  + df(q1(x(1)),x(3))*df(q1(x(1)),x(1))*x(1)

                                                                 2
 - 2*df(q1(x(1)),x(3))*x(1) - 4*df(x(1),x(3))))/(4*sin(x(2))*x(1) )

ricci(0,2) := ricci(2,0) := (2*cos(x(2))*x(1)*( - df(q1(x(1)),x(2))

*df(x(2),x(0))*x(1) + 2*df(x(2),x(2),x(0))*x(1) + 2*df(x(2),x(0))*

                                                         2
df(x(1),x(2))) + sin(x(2))*(2*df(p1(x(1)),x(2),x(0))*x(1)  + df(p1(

                                  2
x(1)),x(2))*df(p1(x(1)),x(0))*x(1)  - 2*df(p1(x(1)),x(2))*df(x(1),x

                                                    2
(0))*x(1) - df(p1(x(1)),x(0))*df(q1(x(1)),x(2))*x(1)  - 2*df(q1(x(1

                                                  2
)),x(2))*df(x(1),x(0))*x(1) - 4*df(x(2),x(0))*x(1)  + 4*df(x(1),x(2

                                                                2
),x(0))*x(1) - 4*df(x(1),x(2))*df(x(1),x(0))))/(4*sin(x(2))*x(1) )

ricci(1,2) := ricci(2,1) := (2*cos(x(2))*x(1)*( - df(p1(x(1)),x(2))

*df(x(2),x(1))*x(1) + 2*df(x(2),x(2),x(1))*x(1) + 2*df(x(2),x(1))*

df(x(1),x(2))) + sin(x(2))*( - df(p1(x(1)),x(2))*df(q1(x(1)),x(1))*

    2                                                           2
x(1)  - 2*df(p1(x(1)),x(2))*x(1) + 2*df(q1(x(1)),x(2),x(1))*x(1)

                                           2
 + df(q1(x(1)),x(2))*df(q1(x(1)),x(1))*x(1)  - 2*df(q1(x(1)),x(2))*

                           2                                      2
x(1) - 4*df(x(2),x(1))*x(1)  - 4*df(x(1),x(2))))/(4*sin(x(2))*x(1)

)

                                                  2
ricci(2,2) := ricci(2,2) := (4*cos(x(2))*sin(x(2)) *x(1)*(df(x(2),x

      q1(x(1))     2                                p1(x(1))     2
(1))*e        *x(1)  - df(x(2),x(0))*df(x(1),x(0))*e        *x(1)

                  p1(x(1))  q1(x(1))
 + df(x(1),x(2))*e        *e        ) - 4*cos(x(2))*df(x(2),x(3))*

               p1(x(1))  q1(x(1))                 3
df(x(1),x(3))*e        *e        *x(1) + sin(x(2)) *(2*df(p1(x(1)),

         p1(x(1))  q1(x(1))     2                    2  p1(x(1))
x(2),2)*e        *e        *x(1)  + df(p1(x(1)),x(2)) *e        *e

q1(x(1))     2                                      p1(x(1))  q1(x(
        *x(1)  - 2*df(p1(x(1)),x(2))*df(x(1),x(2))*e        *e

1))                             q1(x(1))     3
   *x(1) - 2*df(p1(x(1)),x(1))*e        *x(1)  - 2*df(p1(x(1)),x(0)

                 p1(x(1))     3                          p1(x(1))
)*df(x(1),x(0))*e        *x(1)  + 2*df(q1(x(1)),x(2),2)*e        *e

q1(x(1))     2                    2  p1(x(1))  q1(x(1))     2
        *x(1)  + df(q1(x(1)),x(2)) *e        *e        *x(1)  - 2*

                                 p1(x(1))  q1(x(1))
df(q1(x(1)),x(2))*df(x(1),x(2))*e        *e        *x(1) + 2*df(q1(

             q1(x(1))     3                                      p1
x(1)),x(1))*e        *x(1)  + 2*df(q1(x(1)),x(0))*df(x(1),x(0))*e

(x(1))     3                      p1(x(1))  q1(x(1))
      *x(1)  + 4*df(x(1),x(2),2)*e        *e        *x(1) - 4*df(x(

        2  p1(x(1))  q1(x(1))                      p1(x(1))     3
1),x(2)) *e        *e         - 4*df(x(1),x(0),2)*e        *x(1)

                  2  p1(x(1))     2      p1(x(1))  q1(x(1))     2
 - 4*df(x(1),x(0)) *e        *x(1)  - 4*e        *e        *x(1)

      q1(x(1))     2                 p1(x(1))  q1(x(1))
 + 4*e        *x(1) ) + 2*sin(x(2))*e        *e        *(df(p1(x(1)

),x(3))*df(x(1),x(3))*x(1) + df(q1(x(1)),x(3))*df(x(1),x(3))*x(1)

                                           2               3  p1(x(
 + 2*df(x(1),x(3),2)*x(1) - 2*df(x(1),x(3)) ))/(4*sin(x(2)) *e

1))  q1(x(1))     2
   *e        *x(1) )

ricci(3,2) := ricci(2,3) := ( - (2*cos(x(2))*x(1))*(df(p1(x(1)),x(3

)) + df(q1(x(1)),x(3))) + sin(x(2))*(2*df(p1(x(1)),x(3),x(2))*x(1)

 + df(p1(x(1)),x(3))*df(p1(x(1)),x(2))*x(1) - 2*df(p1(x(1)),x(3))*

df(x(1),x(2)) - 2*df(p1(x(1)),x(2))*df(x(1),x(3)) + 2*df(q1(x(1)),x

(3),x(2))*x(1) + df(q1(x(1)),x(3))*df(q1(x(1)),x(2))*x(1) - 2*df(q1

(x(1)),x(3))*df(x(1),x(2)) - 2*df(q1(x(1)),x(2))*df(x(1),x(3))))/(4

*sin(x(2))*x(1))

ricci(0,3) := ricci(3,0) := (2*cos(x(2))*df(x(2),x(0))*x(1)*( - df(

p1(x(1)),x(3))*x(1) - 2*df(x(1),x(3))) + sin(x(2))*(2*df(p1(x(1)),x

              2                                           2
(3),x(0))*x(1)  + df(p1(x(1)),x(3))*df(p1(x(1)),x(0))*x(1)  - 2*df(

p1(x(1)),x(3))*df(x(1),x(0))*x(1) - df(p1(x(1)),x(0))*df(q1(x(1)),x

         2
(3))*x(1)  - 2*df(q1(x(1)),x(3))*df(x(1),x(0))*x(1) + 4*df(x(1),x(3

                                                                2
),x(0))*x(1) - 4*df(x(1),x(3))*df(x(1),x(0))))/(4*sin(x(2))*x(1) )

ricci(1,3) := ricci(3,1) := (2*cos(x(2))*df(x(2),x(1))*x(1)*( - df(

q1(x(1)),x(3))*x(1) - 2*df(x(1),x(3))) + sin(x(2))*( - df(p1(x(1)),

                            2
x(3))*df(q1(x(1)),x(1))*x(1)  - 2*df(p1(x(1)),x(3))*x(1) + 2*df(q1(

                     2                                           2
x(1)),x(3),x(1))*x(1)  + df(q1(x(1)),x(3))*df(q1(x(1)),x(1))*x(1)

                                                                 2
 - 2*df(q1(x(1)),x(3))*x(1) - 4*df(x(1),x(3))))/(4*sin(x(2))*x(1) )

ricci(2,3) := ricci(3,2) := ( - (2*cos(x(2))*x(1))*(df(p1(x(1)),x(3

)) + df(q1(x(1)),x(3))) + sin(x(2))*(2*df(p1(x(1)),x(3),x(2))*x(1)

 + df(p1(x(1)),x(3))*df(p1(x(1)),x(2))*x(1) - 2*df(p1(x(1)),x(3))*

df(x(1),x(2)) - 2*df(p1(x(1)),x(2))*df(x(1),x(3)) + 2*df(q1(x(1)),x

(3),x(2))*x(1) + df(q1(x(1)),x(3))*df(q1(x(1)),x(2))*x(1) - 2*df(q1

(x(1)),x(3))*df(x(1),x(2)) - 2*df(q1(x(1)),x(2))*df(x(1),x(3))))/(4

*sin(x(2))*x(1))

                                                  2
ricci(3,3) := ricci(3,3) := (2*cos(x(2))*sin(x(2)) *x(1)*(df(p1(x(1

          p1(x(1))  q1(x(1))
)),x(2))*e        *e        *x(1) - df(p1(x(1)),x(1))*df(x(2),x(1))

  q1(x(1))     3                                    p1(x(1))     3
*e        *x(1)  - df(p1(x(1)),x(0))*df(x(2),x(0))*e        *x(1)

                      p1(x(1))  q1(x(1))
 + df(q1(x(1)),x(2))*e        *e        *x(1) + df(q1(x(1)),x(1))*

               q1(x(1))     3                                    p1
df(x(2),x(1))*e        *x(1)  + df(q1(x(1)),x(0))*df(x(2),x(0))*e

(x(1))     3                      q1(x(1))     3
      *x(1)  + 2*df(x(2),x(1),2)*e        *x(1)  + 6*df(x(2),x(1))*

 q1(x(1))     2                      p1(x(1))     3
e        *x(1)  - 2*df(x(2),x(0),2)*e        *x(1)  - 6*df(x(2),x(0

                  p1(x(1))     2                    p1(x(1))  q1(x(
))*df(x(1),x(0))*e        *x(1)  + 2*df(x(1),x(2))*e        *e

1))                               p1(x(1))  q1(x(1))
   ) + 2*cos(x(2))*df(x(2),x(3))*e        *e        *x(1)*( - df(p1

(x(1)),x(3))*x(1) - df(q1(x(1)),x(3))*x(1) - 2*df(x(1),x(3))) + 2*

         3                                   p1(x(1))  q1(x(1))
sin(x(2)) *(df(p1(x(1)),x(2))*df(x(1),x(2))*e        *e        *x(1

                                   q1(x(1))     3
            ) - df(p1(x(1)),x(1))*e        *x(1)  - df(p1(x(1)),x(0

                              p1(x(1))     3
            ))*df(x(1),x(0))*e        *x(1)  + df(q1(x(1)),x(2))*df

                         p1(x(1))  q1(x(1))
            (x(1),x(2))*e        *e        *x(1) + df(q1(x(1)),x(1)

               q1(x(1))     3                                    p1
            )*e        *x(1)  + df(q1(x(1)),x(0))*df(x(1),x(0))*e

            (x(1))     3                  2  q1(x(1))     4
                  *x(1)  - 2*df(x(2),x(1)) *e        *x(1)  + 2*df(

                      2  p1(x(1))     4                      p1(x(1
            x(2),x(0)) *e        *x(1)  + 2*df(x(1),x(2),2)*e

            ))  q1(x(1))                       2  p1(x(1))  q1(x(1)
              *e        *x(1) - 2*df(x(1),x(2)) *e        *e

            )                      p1(x(1))     3
              - 2*df(x(1),x(0),2)*e        *x(1)  - 2*df(x(1),x(0))

            2  p1(x(1))     2      p1(x(1))  q1(x(1))     2      q1
             *e        *x(1)  - 2*e        *e        *x(1)  + 2*e

            (x(1))     2               p1(x(1))  q1(x(1))
                  *x(1) ) + sin(x(2))*e        *e        *(2*df(p1(

                  2                    2     2
x(1)),x(3),2)*x(1)  + df(p1(x(1)),x(3)) *x(1)  - 2*df(p1(x(1)),x(3)

                                                 2
)*df(x(1),x(3))*x(1) + 2*df(q1(x(1)),x(3),2)*x(1)  + df(q1(x(1)),x(

   2     2
3)) *x(1)  - 2*df(q1(x(1)),x(3))*df(x(1),x(3))*x(1) + 4*df(x(1),x(3

                           2                 p1(x(1))  q1(x(1))
),2)*x(1) - 4*df(x(1),x(3)) ))/(4*sin(x(2))*e        *e        *x(1

 2
) )


comment finally compute and print the ricci scalar;

r:=for i:=0:3 sum for j:=0:3 sum h(i,j)*ricci(i,j);

                           2                             p1(x(1))
r := (2*cos(x(2))*sin(x(2)) *x(1)*( - df(p1(x(1)),x(2))*e        *e

      q1(x(1))                                         q1(x(1))
              *x(1) + df(p1(x(1)),x(1))*df(x(2),x(1))*e        *x(1

       3                                    p1(x(1))     3
      )  + df(p1(x(1)),x(0))*df(x(2),x(0))*e        *x(1)  - df(q1(

                   p1(x(1))  q1(x(1))
      x(1)),x(2))*e        *e        *x(1) - df(q1(x(1)),x(1))*df(x

                 q1(x(1))     3
      (2),x(1))*e        *x(1)  - df(q1(x(1)),x(0))*df(x(2),x(0))*e

      p1(x(1))     3                      q1(x(1))     3
              *x(1)  - 2*df(x(2),x(1),2)*e        *x(1)  - 6*df(x(2

               q1(x(1))     2                      p1(x(1))     3
      ),x(1))*e        *x(1)  + 2*df(x(2),x(0),2)*e        *x(1)

                                        p1(x(1))     2
       + 6*df(x(2),x(0))*df(x(1),x(0))*e        *x(1)  - 2*df(x(1),

             p1(x(1))  q1(x(1))                               p1(x(
      x(2))*e        *e        ) + 2*cos(x(2))*df(x(2),x(3))*e

      1))  q1(x(1))
         *e        *x(1)*(df(p1(x(1)),x(3))*x(1) + df(q1(x(1)),x(3)

                                           3
      )*x(1) + 2*df(x(1),x(3))) + sin(x(2)) *( - 2*df(p1(x(1)),x(2)

           p1(x(1))  q1(x(1))     2                    2  p1(x(1))
      ,2)*e        *e        *x(1)  - df(p1(x(1)),x(2)) *e        *

       q1(x(1))     2                                        p1(x(1
      e        *x(1)  - df(p1(x(1)),x(2))*df(q1(x(1)),x(2))*e

      ))  q1(x(1))     2                                        q1(
        *e        *x(1)  + df(p1(x(1)),x(1))*df(q1(x(1)),x(1))*e

      x(1))     4                        q1(x(1))     3
           *x(1)  + 4*df(p1(x(1)),x(1))*e        *x(1)  + 2*df(p1(x

                    p1(x(1))     4                    2  p1(x(1))
      (1)),x(0),2)*e        *x(1)  + df(p1(x(1)),x(0)) *e        *x

         4                                        p1(x(1))     4
      (1)  - df(p1(x(1)),x(0))*df(q1(x(1)),x(0))*e        *x(1)  + 

                                         p1(x(1))     3
      4*df(p1(x(1)),x(0))*df(x(1),x(0))*e        *x(1)  - 2*df(q1(x

                    p1(x(1))  q1(x(1))     2                    2
      (1)),x(2),2)*e        *e        *x(1)  - df(q1(x(1)),x(2)) *e

      p1(x(1))  q1(x(1))     2                          q1(x(1))
              *e        *x(1)  - 2*df(q1(x(1)),x(1),2)*e        *x(

        4                    2  q1(x(1))     4
      1)  - df(q1(x(1)),x(1)) *e        *x(1)  - 4*df(q1(x(1)),x(1)

         q1(x(1))     3                                      p1(x(1
      )*e        *x(1)  - 4*df(q1(x(1)),x(0))*df(x(1),x(0))*e

      ))     3                  2  q1(x(1))     4
        *x(1)  + 4*df(x(2),x(1)) *e        *x(1)  - 4*df(x(2),x(0))

      2  p1(x(1))     4                      p1(x(1))  q1(x(1))
       *e        *x(1)  - 4*df(x(1),x(2),2)*e        *e        *x(1

                         2  p1(x(1))  q1(x(1))
      ) + 4*df(x(1),x(2)) *e        *e         + 8*df(x(1),x(0),2)*

       p1(x(1))     3                  2  p1(x(1))     2      p1(x(
      e        *x(1)  + 4*df(x(1),x(0)) *e        *x(1)  + 4*e

+++ GC number 2 - collection complete (15260 Kbytes free)
      1))  q1(x(1))     2      q1(x(1))     2               p1(x(1)
         *e        *x(1)  - 4*e        *x(1) ) + sin(x(2))*e

      )  q1(x(1))                               2
       *e        *( - 2*df(p1(x(1)),x(3),2)*x(1)  - df(p1(x(1)),x(3

        2     2                                           2
      )) *x(1)  - df(p1(x(1)),x(3))*df(q1(x(1)),x(3))*x(1)  - 2*df(

                           2                    2     2
      q1(x(1)),x(3),2)*x(1)  - df(q1(x(1)),x(3)) *x(1)  - 4*df(x(1)

                                     2               3  p1(x(1))
      ,x(3),2)*x(1) + 4*df(x(1),x(3)) ))/(2*sin(x(2)) *e        *e

     q1(x(1))     4
             *x(1) )


comment end of ricci tensor and scalar calculation;

comment end of all examples;

end;
ENTERING LISP...
Value: nil


Value: !$eof!$
