load_package linalg,sparse;



on backtrace;



on rounded;


print_precision 6;



matrix tmp1,tmp2;



listproc compare_sparse(spsvdlis,svdlis);
begin scalar z;
   z := {};
   tmp1 := third spsvdlis; tmp2:= third svdlis;
   z := 
      (for i:=1:first length tmp2 collect
	 for j:=1:second length tmp2 collect
	    tmp1(i,j) - tmp2(i,j)) . z;
   tmp1 := second spsvdlis; tmp2:= second svdlis;
   z := 
      (for i:=1:first length tmp2 collect
	 for j:=1:second length tmp2 collect
	    tmp1(i,j) - tmp2(i,j)) . z;
   tmp1 := first spsvdlis; tmp2:= first svdlis;
   z := 
      (for i:=1:first length tmp2 collect
	 for j:=1:second length tmp2 collect
	    tmp1(i,j) - tmp2(i,j)) . z;
   return z;
end;


compare_sparse


mata := mat((-2,3),(5,7));


        [-2  3]
mata := [     ]
        [5   7]


matb := mata/3;


        [-0.666667     1   ]
matb := [                  ]
        [ 1.66667   2.33333]


matc := mata/2;


        [-1   1.5]
matc := [        ]
        [2.5  3.5]



svda := svd(mata);


svda := {

         [0.985061   0.172205]
         [                   ]
         [-0.172205  0.985061]

         ,


         [3.32821     0   ]
         [                ]
         [   0     8.71338]

         ,


         [-0.850651  0.525731]
         [                   ]
         [0.525731   0.850651]

         }

svdb := svd(matb);


svdb := {

         [0.985061   0.172205]
         [                   ]
         [-0.172205  0.985061]

         ,


         [1.1094     0   ]
         [               ]
         [  0     2.90446]

         ,


         [-0.850651  0.525731]
         [                   ]
         [0.525731   0.850651]

         }

svdc := svd(matc);


svdc := {

         [0.985061   0.172205]
         [                   ]
         [-0.172205  0.985061]

         ,


         [1.66411     0   ]
         [                ]
         [   0     4.35669]

         ,


         [-0.850651  0.525731]
         [                   ]
         [0.525731   0.850651]

         }

  
mat01 := mat((12,1,0,0,0),
   (1,9,1,0,0),
   (0,1,6,1,0),
   (0,0,1,3,1),
   (0,0,0,1,0));


         [12  1  0  0  0]
         [              ]
         [1   9  1  0  0]
         [              ]
mat01 := [0   1  6  1  0]
         [              ]
         [0   0  1  3  1]
         [              ]
         [0   0  0  1  0]



svd01 := svd(mat01);


svd01 := {

          [ -0.952145     0.301047    -0.0524864  0.00592653  -0.000427198]
          [                                                               ]
          [ -0.301712     -0.898284    0.314918   -0.0534344   0.00526174 ]
          [                                                               ]
          [ -0.0485958    -0.315542   -0.892269    0.315542    -0.0485958 ]
          [                                                               ]
          [-0.00526174   -0.0534344   -0.314918   -0.898284     0.301712  ]
          [                                                               ]
          [-0.000427198  -0.00592653  -0.0524864  -0.301047    -0.952145  ]

          ,


          [12.3169     0      0      0        0    ]
          [                                        ]
          [   0     9.01614   0      0        0    ]
          [                                        ]
          [   0        0     6.0     0        0    ]
          [                                        ]
          [   0        0      0   2.98386     0    ]
          [                                        ]
          [   0        0      0      0     0.316876]

          ,


          [ -0.952145     0.301047    -0.0524864  0.00592653  0.000427198]
          [                                                              ]
          [ -0.301712     -0.898284    0.314918   -0.0534344  -0.00526174]
          [                                                              ]
          [ -0.0485958    -0.315542   -0.892269    0.315542    0.0485958 ]
          [                                                              ]
          [-0.00526174   -0.0534344   -0.314918   -0.898284    -0.301712 ]
          [                                                              ]
          [-0.000427198  -0.00592653  -0.0524864  -0.301047    0.952145  ]

          }


first(svd01)*second(svd01)*tp third(svd01);


mat((12.0,1.0,-0.0000000242234,-0.00000000682079,-0.000000000877698),

    (1.0,9.0,1.0,0.0000000165459,0.00000000114123),

    (0.00000000133901,1.0,6.0,1.0,0.0000000110636),

    (0.000000000192261,-0.00000000095422,1.0,3.0,1.0),

    (0.0000000000176379,-0.000000000072629,-0.0000000000990724,1.0,

     0.00000000058774))


ws-mat01;


mat((-0.00000000140327,0.00000000845024,-0.0000000242234,-0.00000000682079,

     -0.000000000877698),

    (0.00000000442007,-0.0000000267113,0.0000000774353,0.0000000165459,

     0.00000000114123),

    (0.00000000133901,-0.00000000746781,0.0000000159589,0.0000000376173,

     0.0000000110636),

    (0.000000000192261,-0.00000000095422,0.00000000087305,0.000000011568,

     0.00000000361564),

    (0.0000000000176379,-0.000000000072629,-0.0000000000990724,0.00000000184019,

     0.00000000058774))



sparse spmat01(5,5);


for i:=1:first length mat01 do
   for j:=1:second length mat01 do
      if mat01(i,j) neq 0 then spmat01(i,j) := mat01(i,j);



%spsvd01 := spsvd(spmat01);

%compare_sparse(spsvd01,svd01);


mat02 := mat((3,2,2),(2,3,-2));


         [3  2  2 ]
mat02 := [        ]
         [2  3  -2]



svd02 := svd(mat02);


svd02 := {

          [-0.707107  0.707107 ]
          [                    ]
          [-0.707107  -0.707107]

          ,


          [5.0   0 ]
          [        ]
          [ 0   3.0]

          ,


          [-0.707107  0.235702 ]
          [                    ]
          [-0.707107  -0.235702]
          [                    ]
          [    0      0.942809 ]

          }


first(svd02)*second(svd02)*tp third(svd02);


[3.0  2.0  2.0 ]
[              ]
[2.0  3.0  -2.0]


ws-mat02;


[0  0  0]
[       ]
[0  0  0]



sparse spmat02(2,3);


for i:=1:first length mat02 do
   for j:=1:second length mat02 do
      if mat02(i,j) neq 0 then spmat02(i,j) := mat02(i,j);



%spsvd02 := spsvd(spmat02);

%compare_sparse(spsvd02,svd02);


mat03 := mat((-3,1),(6,-2),(6,-2));


         [-3  1 ]
         [      ]
mat03 := [6   -2]
         [      ]
         [6   -2]



svd03 := svd(mat03);


svd03 := {

          [-0.333333  0.666667 ]
          [                    ]
          [0.666667   0.666667 ]
          [                    ]
          [0.666667   -0.333333]

          ,


          [9.48683  0]
          [          ]
          [   0     0]

          ,


          [0.948683   -0.316228]
          [                    ]
          [-0.316228  -0.948683]

          }


first(svd03)*second(svd03)*tp third(svd03);


[-3.0   1  ]
[          ]
[6.0   -2.0]
[          ]
[6.0   -2.0]


ws-mat03;


[0  0]
[    ]
[0  0]
[    ]
[0  0]



sparse spmat03(3,2);


for i:=1:first length mat03 do
   for j:=1:second length mat03 do
      if mat03(i,j) neq 0 then spmat03(i,j) := mat03(i,j);



%spsvd03 := spsvd(spmat03);

%compare_sparse(spsvd02,svd02);


mat04 := mat((3,4),(0,5));


         [3  4]
mat04 := [    ]
         [0  5]



svd04 := svd(mat04);


svd04 := {

          [0.707107   0.707107]
          [                   ]
          [-0.707107  0.707107]

          ,


          [2.23607    0   ]
          [               ]
          [   0     6.7082]

          ,


          [0.948683   0.316228]
          [                   ]
          [-0.316228  0.948683]

          }


first(svd04)*second(svd04)*tp third(svd04);


[3.0  4.0]
[        ]
[ 0   5.0]


ws-mat04;


[0  0]
[    ]
[0  0]



sparse spmat04(2,2);


for i:=1:first length mat04 do
   for j:=1:second length mat04 do
      if mat04(i,j) neq 0 then spmat04(i,j) := mat04(i,j);



%spsvd04 := spsvd(spmat04);

%compare_sparse(spsvd02,svd02);


mat05 := mat((1,0,-1),(0,1,0));


         [1  0  -1]
mat05 := [        ]
         [0  1  0 ]



svd05 := svd(mat05);


svd05 := {

          [-1  0 ]
          [      ]
          [0   -1]

          ,


          [1.41421  0]
          [          ]
          [   0     1]

          ,


          [-0.707107  0 ]
          [             ]
          [    0      -1]
          [             ]
          [0.707107   0 ]

          }


first(svd05)*second(svd05)*tp third(svd05);


[1  0  -1]
[        ]
[0  1  0 ]


ws-mat05;


[0  0  0]
[       ]
[0  0  0]



sparse spmat05(2,3);


for i:=1:first length mat05 do
   for j:=1:second length mat05 do
      if mat05(i,j) neq 0 then spmat05(i,j) := mat05(i,j);



%spsvd05 := spsvd(spmat05);

%compare_sparse(spsvd02,svd02);


mat06 := mat((3,0),(4,5));


         [3  0]
mat06 := [    ]
         [4  5]



svd06 := svd(mat06);


svd06 := {

          [-0.316228  0.948683 ]
          [                    ]
          [-0.948683  -0.316228]

          ,


          [6.7082     0   ]
          [               ]
          [  0     2.23607]

          ,


          [-0.707107  0.707107 ]
          [                    ]
          [-0.707107  -0.707107]

          }


first(svd06)*second(svd06)*tp third(svd06);


[3.0   0 ]
[        ]
[4.0  5.0]


ws-mat06;


[0  0]
[    ]
[0  0]



sparse spmat06(2,2);


for i:=1:first length mat06 do
   for j:=1:second length mat06 do
      if mat06(i,j) neq 0 then spmat06(i,j) := mat06(i,j);



%spsvd06 := spsvd(spmat06);

%compare_sparse(spsvd02,svd02);


mat07 := mat((0,1,0,0),(0,0,2,0),(0,0,0,3),(0,0,0,0));


         [0  1  0  0]
         [          ]
         [0  0  2  0]
mat07 := [          ]
         [0  0  0  3]
         [          ]
         [0  0  0  0]



svd07 := svd(mat07);


svd07 := {

          [0  -1  0   0 ]
          [             ]
          [0  0   -1  0 ]
          [             ]
          [0  0   0   -1]
          [             ]
          [1  0   0   0 ]

          ,


          [0  0   0    0 ]
          [              ]
          [0  1   0    0 ]
          [              ]
          [0  0  2.0   0 ]
          [              ]
          [0  0   0   3.0]

          ,


          [1  0   0   0 ]
          [             ]
          [0  -1  0   0 ]
          [             ]
          [0  0   -1  0 ]
          [             ]
          [0  0   0   -1]

          }


first(svd07)*second(svd07)*tp third(svd07);


[0  1   0    0 ]
[              ]
[0  0  2.0   0 ]
[              ]
[0  0   0   3.0]
[              ]
[0  0   0    0 ]


ws-mat07;


[0  0  0  0]
[          ]
[0  0  0  0]
[          ]
[0  0  0  0]
[          ]
[0  0  0  0]



sparse spmat07(4,4);


for i:=1:first length mat07 do
   for j:=1:second length mat07 do
      if mat07(i,j) neq 0 then spmat07(i,j) := mat07(i,j);



%spsvd07 := spsvd(spmat07);

%compare_sparse(spsvd02,svd02);


mat08 := mat((0,1,0,0),(0,0,2,0),(0,0,0,3),(1/60000,0,0,0));


         [     0        1  0  0]
         [                     ]
         [     0        0  2  0]
mat08 := [                     ]
         [     0        0  0  3]
         [                     ]
         [0.0000166667  0  0  0]



svd08 := svd(mat08);


svd08 := {

          [0   -1  0   0]
          [             ]
          [0   0   -1  0]
          [             ]
          [0   0   0   1]
          [             ]
          [-1  0   0   0]

          ,


          [0.0000166667  0   0    0 ]
          [                         ]
          [     0        1   0    0 ]
          [                         ]
          [     0        0  2.0   0 ]
          [                         ]
          [     0        0   0   3.0]

          ,


          [-1  0   0   0]
          [             ]
          [0   -1  0   0]
          [             ]
          [0   0   -1  0]
          [             ]
          [0   0   0   1]

          }


first(svd08)*second(svd08)*tp third(svd08);


[     0        1   0    0 ]
[                         ]
[     0        0  2.0   0 ]
[                         ]
[     0        0   0   3.0]
[                         ]
[0.0000166667  0   0    0 ]


ws-mat08;


[0  0  0  0]
[          ]
[0  0  0  0]
[          ]
[0  0  0  0]
[          ]
[0  0  0  0]



sparse spmat08(4,4);


for i:=1:first length mat08 do
   for j:=1:second length mat08 do
      if mat08(i,j) neq 0 then spmat08(i,j) := mat08(i,j);



%spsvd08 := spsvd(spmat08);

%compare_sparse(spsvd02,svd02);


mat09 := mat((1,0,0,0,2),
   (0,0,3,0,0),
   (0,0,0,0,0),
   (0,4,0,0,0));


         [1  0  0  0  2]
         [             ]
         [0  0  3  0  0]
mat09 := [             ]
         [0  0  0  0  0]
         [             ]
         [0  4  0  0  0]



svd09 := svd(mat09);


svd09 := {

          [-1  0   0  0 ]
          [             ]
          [0   -1  0  0 ]
          [             ]
          [0   0   1  0 ]
          [             ]
          [0   0   0  -1]

          ,


          [2.23607   0   0   0 ]
          [                    ]
          [   0     3.0  0   0 ]
          [                    ]
          [   0      0   0   0 ]
          [                    ]
          [   0      0   0  4.0]

          ,


          [-0.447214  0   0   0 ]
          [                     ]
          [    0      0   0   -1]
          [                     ]
          [    0      -1  0   0 ]
          [                     ]
          [    0      0   -1  0 ]
          [                     ]
          [-0.894427  0   0   0 ]

          }


first(svd09)*second(svd09)*tp third(svd09);


[1   0    0   0  2.0]
[                   ]
[0   0   3.0  0   0 ]
[                   ]
[0   0    0   0   0 ]
[                   ]
[0  4.0   0   0   0 ]


ws-mat09;


[0  0  0  0  0]
[             ]
[0  0  0  0  0]
[             ]
[0  0  0  0  0]
[             ]
[0  0  0  0  0]



sparse spmat09(4,5);


for i:=1:first length mat09 do
   for j:=1:second length mat09 do
      if mat09(i,j) neq 0 then spmat09(i,j) := mat09(i,j);



%spsvd09 := spsvd(spmat09);

%compare_sparse(spsvd02,svd02);


end;

