\subsection{Special Functions: Introduction}
\index{Special functions}
\index{Gamma function}
\index{Beta function}
\index{Digamma function}
\index{Psi function}
\index{Polygamma functions}
\index{Airy functions}
\index{Bessel functions}
\index{Hankel functions}
\index{Kummer functions}
\index{Struve functions}
\index{Lommel functions}
\index{Whittaker functions}
\index{polylogarithm and related functions} \index{Dilog function}
\index{Riemann Zeta function}
\index{Lambert's W function}
\index{3j and 6j symbols} \index{Clebsch Gordan coefficients}
\index{Spherical and Solid Harmonics}
\index{Jacobi Elliptic functions}
\index{Elliptic Integrals}
\index{Nome and Related functions}
\index{Jacobi Theta functions}
\index{Theta function derivatives}
\index{Weierstrass Elliptic functions}
\index{Sigma functions}
\index{Inverse Elliptic functions}
\index{Period Lattice and Related functions}
\index{Stirling numbers}
\hypertarget{SPECFNS}{}
%% For MathJax, must be part of a paragraph to avoid extra space:
\ifdefined\VerbMath{\makehashletter
\(\newcommand{\f}[1]{\texttt{#1}}\)%
}\fi
%
The package SPECFN is designed to provide algebraic and numeric manipulations of
many common special functions, namely:

\begin{itemize}
\item \hyperlink{INTEGF}{The Exponential Integral, Sine \& Cosine Integrals};
\item \hyperlink{INTEGF}{The Hyperbolic Sine \& Cosine Integrals};
\item \hyperlink{INTEGF}{The Fresnel Integrals \& Error function};
\item \hyperlink{GAMMF}{The Gamma function};
\item \hyperlink{BETAF}{The Beta function};
\item \hyperlink{DIGAM}{The psi function} \& its \hyperlink{POLYGAM}{derivatives};
\item \hyperlink{BESSELF}{The Bessel functions} $J$ and $Y$ of the first and second kinds;
\item \hyperlink{BESSELF}{The modified Bessel functions} $I$ and $K$;
\item \hyperlink{BESSELF}{The Hankel functions} $H^{(1)}$ and $H^{(2)}$;
\item \hyperlink{AIRYF}{The Airy functions};
\item \hyperlink{HYPERGEOM}{The Kummer hypergeometric functions} M and U;
\item \hyperlink{HYPERGEOM}{The Struve, Lommel and Whittaker functions};
\item \hyperlink{RIEMZETA}{The Riemann Zeta function};
\item \hyperlink{POLYLOG}{The Dilog function};
\item \hyperlink{POLYLOG}{The Polylog and Lerch Phi functions};
\item \hyperlink{LAMBERTW}{Lambert's W function};
\item \hyperlink{SPHSOLH}{Associated Legendre Functions}
(Spherical and Solid Harmonics);
\item \hyperlink{CLEBSCHG}{3j and 6j symbols, Clebsch-Gordan coefficients};
\item \hyperlink{JACEF}{Jacobi's Elliptic Functions};
\item \hyperlink{ELLIPI}{Elliptic Integrals};
\item \hyperlink{ELLIPNOME}{Nome and Related Functions};
\item \hyperlink{JACTF}{Jacobi's Theta Functions} and their
\hyperlink{THETAD}{ derivatives};
\item \hyperlink{WEIERSTRASS}{Weierstrass Elliptic Functions} and the
\hyperlink{SIGMA}{Sigma Function};
\item \hyperlink{SIGMA1}{Other Sigma Functions};
\item \hyperlink{ETA}{Period Lattice and Related Functions};
\item \hyperlink{INVELL}{Inverse Elliptic Functions};  
\item \hyperlink{STIRL}{Stirling Numbers};
\item and some \hyperlink{CONSTS}{well-known constants}.
\end{itemize}

All of the above functions (except Stirling numbers) are autoloading.

More information on all these functions may be found on the website
\href{https://dlmf.nist.gov/}{DLMF:NIST} although currently not all functions
may conform to these standards.

All algorithms whose sources are uncredited are culled from series or
expressions found in the Dover Handbook of Mathematical
Functions\cite{AbramowitzStegun:72}.

There is a nice collection of plot calls for special functions
in the file \texttt{specplot.tst} in the subfolder \texttt{plot} of the
packages folder. These examples will reproduce a number of well-known
pictures from \cite{AbramowitzStegun:72}.

\subsection{Polynomial Functions: Introduction}
\index{Polynomial functions}
Most of these polynomial functions are not  autoloading. This package needs
to be loaded before they may be used with the command:
\begin{verbatim}
        load_package specfn;
\end{verbatim}

\subsubsection{Orthogonal Polynomial Functions}
\index{Orthogonal polynomials}
\index{Hermite polynomials}\index{Jacobi polynomials}
\index{Legendre polynomials}\index{Laguerre polynomials}
\index{Chebyshev polynomials}\index{Gegenbauer polynomials}

The polynomial function sets available are:
\begin{itemize}
\item \hyperlink{HERMITEP}{Hermite Polynomials};
\item \hyperlink{LEGENDREP}{Legendre Polynomials};
\item \hyperlink{LAGUERREP}{Laguerre Polynomials};
\item \hyperlink{CHEBYSHEVP}{Chebyshev Polynomials};
\item \hyperlink{JACOBIP}{Jacobi Polynomials};
\item \hyperlink{GEGENBAUERP}{Gegenbauer Polynomials};
\end{itemize}

\subsubsection{Other Polynomial Functions}
\index{Other polynomials}\index{Bernoulli polynomials}
\index{Euler polynomials}\index{Fibonacci polynomials}

\begin{itemize}
\item \hyperlink{BERNOULLIP}{Bernoulli Numbers \& Polynomials};
\item \hyperlink{EULERP}{Euler  Numbers \& Polynomials};
\item \hyperlink{FIBONACCIP}{Fibonnacci  Numbers \& Polynomials};
\end{itemize}

\subsection{Simplification and Approximation}

All of the operators supported by this package have certain algebraic
simplification rules to handle special cases, poles, derivatives and so
on.  Such rules are applied whenever they are appropriate.  However, if
the \sw{ROUNDED} switch is on, numeric evaluation is also carried out.
Unless otherwise stated below, the result of an application of a special
function operator to real or complex numeric arguments in rounded mode
will be approximated numerically whenever it is possible to do so.  All
approximations are to the current precision.

Most algebraic simplifications within the special function package
are defined in the form of a \REDUCE{} ruleset. Therefore, in order to
get a quick insight into the simplification rules one can use the
ShowRules operator, e.g.
\begin{verbatim}
ShowRules BesselI;

                          1          ~z     - ~z
{besseli(~n,~z) => ---------------*(e   - e     )
                    sqrt(pi*2*~z)

                           1
  when numberp(~n) and ~n=---,
                           2

                          1          ~z     - ~z
 besseli(~n,~z) => ---------------*(e   + e     )
                    sqrt(pi*2*~z)

                              1
  when numberp(~n) and ~n= - ---,
                              2

 besseli(~n,~z) => 0

  when numberp(~z) and ~z=0 and numberp(~n) and ~n neq 0,

 besseli(~n,~z) => besseli( - ~n,~z) when numberp(~n)

  and impart(~n)=0 and ~n=floor(~n) and ~n<0,

 besseli(~n,~z) => do*i(~n,~z)

  when numberp(~n) and numberp(~z) and *rounded,

 df(besseli(~n,~z),~z)

      besseli(~n - 1,~z) + besseli(~n + 1,~z)
  => -----------------------------------------,
                         2

 df(besseli(~n,~z),~z)

  => besseli(1,~z) when numberp(~n) and ~n=0}
\end{verbatim}
Several \REDUCE\ packages (such as Sum or Limits) obtain different
(hopefully better)
results for the algebraic simplifications when the SPECFN package
is loaded, because the latter package contains some information which
may be useful and directly applicable for other packages, e.g.:

\begin{verbatim}
sum(1/k^s,k,1,infinity);  % evaluates to zeta(s)
\end{verbatim}

\ttindexswitch{savesfs}
A record is kept of all values previously approximated, so that should a
value be required which has already been computed to the current
precision or greater, it can be simply looked up.  This can result in
some storage overheads, particularly if many values are computed which
will not be needed again.  In this case, the switch \sw{savesfs} may be
turned off in order to inhibit the storage of approximated values.  The
switch is on by default.

\subsection{Integral Functions}
\hypertarget{operator:CHI}{}
\hypertarget{operator:CI}{}
\hypertarget{operator:DILOG}{}
\hypertarget{operator:EI}{}
\hypertarget{operator:Erf}{}
\hypertarget{operator:SI}{}
\hypertarget{operator:Shi}{}
\hypertarget{operator:Fresnel_S}{}
\hypertarget{operator:Fresnel_C}{}
\index{Error functions}\index{Integral functions}
\ttindex{Si}\ttindex{Shi}\ttindex{Chi}\ttindex{Ci}
\ttindex{Li}\ttindex{Ei}\ttindex{Erf}
\ttindex{Fresnel\_S}\ttindex{Fresnel\_C}
\hypertarget{INTEGF}{}

The SPECFN package includes manipulation and limited numerical
evaluation for some integral functions, namely

\f{erf}, \f{erfc}, \f{Si}, \f{Shi}, \f{si}, \f{Ci}, \f{Chi}, \f{Ei}, \f{Li},
\f{Fresnel\_C}, and \f{Fresnel\_S}.

The error function, its complement and the two Fresnel integrals are defined by:
\begin{eqnarray*}
\mathrm{erf}(z) & = & \frac{2}{\sqrt \pi}\int_0^z e^{-t^2}\, \mathrm{d}t\\
\mathrm{erfc}(z) & = & \frac{2}{\sqrt \pi}\int_z^\infty e^{-t^2}\, \mathrm{d}t
 = 1 - \mathrm{erf}(z)\\
C(z) & = & \int_0^z \cos\left(\frac{\pi}{2} t^2\right)\, \mathrm{d}t\\
S(z) & = & \int_0^z \sin\left(\frac{\pi}{2} t^2\right)\, \mathrm{d}t
\end{eqnarray*}
respectively.

The exponential and related integrals are defined by the following:
\begin{eqnarray*}
\mathrm{Ei}(z) & = & e^{-z}\int_z^\infty \frac{e^{-t}} {t+z}\, \mathrm{d}t\\
\mathrm{Li}(z) & = & \int_0^z \frac{\mathrm{d}t} {\log t}\\
\mathrm{Si}(z) & = & \int_0^z \frac{\sin t} {t}\, \mathrm{d}t\\
\mathrm{si}(z) & = & -\int_z^\infty \frac{\sin t} {t}\, \mathrm{d}t
 = \mathrm{Si}(z) - \frac{\pi}{2}\\
\mathrm{Ci}(z) & = & -\int_z^\infty  \frac{\cos t} {t}\, \mathrm{d}t
=  \int_0^z \frac{\cos t -1} {t}\, \mathrm{d}t + \log z +\gamma\\
\mathrm{Shi}(z) & = & \int_0^z \frac{\sinh t} {t}\, \mathrm{d}t\\
\mathrm{Chi}(z) & = & \int_0^z \frac{\cosh t -1} {t}\, \mathrm{d}t +\log z +\gamma
\end{eqnarray*}
where $\gamma$ is Euler's constant (\f{Euler\_gamma}).

The definitions of the exponential and related integrals, the
derviatives and some limits are known, together with some simple
properties such as symmetry conditions.

The numerical approximations for the integral functions suffer
from the fact that the precision is not set correctly for
values of the argument above 10.0 (approx.) and from the
usage of summations even for large arguments.

$\mathop{\mathrm{Li}(z)}$ is simplified to $\mathop{\mathrm{Ei}}(\ln(z))$ .

\subsection{The \texorpdfstring{$\Gamma$}{Gamma} Function and Related Functions}

\subsubsection{The \texorpdfstring{$\Gamma$}{Gamma} Function}
\hypertarget{GAMMF}{}
\hypertarget{operator:GAMMA}{}
\hypertarget{operator:IGAMMA}{}
\hypertarget{operator:POLYGAMMA}{}
\hypertarget{operator:PSI}{}
\index{Gamma function}\index{$\Gamma$ function}

This is represented by the unary operator \f{Gamma}.
The \texttt{Gamma} function is defined by the integral:
\[ \Gamma(a) = \int_0^\infty e^{-t}t^{a-1}\, \mathrm{d}t.\]
Initial transformations applied with \sw{ROUNDED} off are: $\Gamma(n)$ for
integral $n$ is computed, $\Gamma(n+1/2)$ for integral $n$ is rewritten to
an expression in $\sqrt\pi$, $\Gamma(n+1/m)$ for natural $n$ and $m$ a
positive integral power of 2 less than or equal to 64 is rewritten to an
expression in $\Gamma(1/m)$, expressions with arguments at which there is a
pole are replaced by \var{INFINITY}, and those with a negative (real)
argument are rewritten so as to have positive arguments.

The algorithm used for numerical approximation is an implementation of an
asymptotic series for $\ln(\Gamma)$, with a scaling factor obtained from
the \hyperlink{POCH}{Pochhammer symbols}.

An expression for $\Gamma'(z)$ in terms of $\Gamma$ and $\psi$ is
included.

\subsubsection{Incomplete Gamma Functions}
\index{Incomplete Gamma functions}
\ttindex{igamma}\ttindex{m\_gamma}
The (unnormalised) incomplete gamma function is provided by the binary function
\f{m\_gamma}. In the literature it is normally represented as $\gamma(a,z)$
and is defined by
\[ \gamma(a, z) = \int_0^z e^{-t}t^{a-1}\, \mathrm{d}t.\]
The normalised incomplete gamma function $P(a,z)$ is provided by the binary
function \f{igamma} and is defined as
\[P(a,z) = \frac{\gamma(a,z)}{\Gamma(a)}.\]

\subsubsection{The Beta Functions}
\hypertarget{BETAF}{}
\hypertarget{operator:BETA}{}
\hypertarget{operator:IBETA}{}
\index{Beta function}
\ttindex{Beta}\ttindex{ibeta}
The binary function $B(a,b)$ is related to the $\Gamma$
function\cite{AbramowitzStegun:72} and is defined by
\[ B(a,b) = \int_0^1 t^a (1-t)^b\, \mathrm{d}t =
\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}.\]
It is represented by the binary function \f{Beta}.

\index{Incomplete Beta functions}
The unnormalised and nomalised incomplete Beta funtions are defined by
\begin{eqnarray*}
B_x(a,b) & = & \int_0^x t^a (1-t)^b\, \mathrm{d}t,\\
I_x(a,b) & = & \frac{B_x(a,b)}{B(a,b)}
\end{eqnarray*}
respectively. The normalised one is represented by the ternary function
\texttt{ibeta(a,b,x)}.

\subsubsection{The Digamma Function, $\psi$}
\hypertarget{DIGAM}{}
\ttindex{psi}\index{$\psi$ function}\index{Psi function}\index{Digamma
function}

This is represented by the unary operator \f{psi}. It is defined as the
logarithmic derivative of the $\Gamma$  function:
\[ \psi(z) = \frac{\Gamma'(z)}{\Gamma(z)}. \]

Initial transformations for $\psi$ are applied on a similar basis to
those for $\Gamma$; where possible, $\psi(x)$ is rewritten in
terms of $\psi(1)$ and $\psi(\frac{1}{2})$, and expressions with negative
arguments are rewritten to have positive ones.

The algorithm for numerical evaluation of $\psi$ is based upon an
asymptotic series, with a suitable scaling.

Relations for the derivative and integral of $\psi$ are included.

\subsubsection{The Polygamma Functions, $\psi^{(n)}$}
\hypertarget{POLYGAM}{}
\ttindex{Polygamma}\index{$\psi^{(n)}$ functions}\index{Polygamma
functions}

The $n$th derivative of the $\psi$ function is represented by the
binary operator \f{Polygamma}, whose first argument is $n$.

Initial manipulations on $\psi^{(n)}$ are few; where the second argument
is $1$ or $3/2$, the expression is rewritten to one involving the
Riemann $\zeta$ function, and when the first is zero it is rewritten to
$\psi$; poles are also handled.

Numerical evaluation is available for real and complex arguments. The
algorithm used is again an asymptotic series with a scaling factor; for
negative (second) arguments, a Reflection Formula is used, introducing a
term in the $n$th derivative of $\cot(z\pi)$.

Simple relations for derivatives and integrals are provided.

\subsection{Bessel Functions}
\hypertarget{operator:BESSELI}{}
\hypertarget{operator:BESSELJ}{}
\hypertarget{operator:BESSELK}{}
\hypertarget{operator:BESSELY}{}
\hypertarget{operator:HANKEL1}{}
\hypertarget{operator:HANKEL2}{}
\hypertarget{BESSELF}{}
\ttindex{BesselJ}\ttindex{BesselY}
\ttindex{BesselI}\ttindex{BesselK}
\ttindex{Hankel1}\ttindex{Hankel2}\index{Bessel functions}
\index{Hankel functions}

Support is provided for the Bessel functions $J$ and $Y$, the modified
Bessel functions $I$ and $K$, and the Hankel functions of the first and
second kinds.  The relevant operators are, respectively, \f{BesselJ},
\f{BesselY}, \f{BesselI}, \f{BesselK}, \f{Hankel1} and \f{Hankel2},
which are all binary operators.

The Bessel functions $J_\nu(z)$ and $Y_\nu(z)$ are solutions of the Bessel
equation:
\[z^2\frac{\mathrm{d}^2w}{\mathrm{d}z^2}+z\frac{\mathrm{d}w}{\mathrm{d}z} +
(z^2 - \nu^2)w = 0.\]
Bessel's function of the first kind, $J_\nu(z)$, has the series expansion:
\[J_\nu(z) = \left(\frac{z}{2}\right)^\nu \sum_{k=0}^\infty (-1)^k
\frac{(z/2)^{2k}}{k! \Gamma(\nu + k+1)}\,.\]
Bessel's function of the second kind, $Y_\nu(z)$, (for non-integral $\nu$) is
defined by:
\[Y_\nu(z) = \frac{J_\nu(z) \cos(\nu\pi)-J_{-\nu}(z)}{\sin(\nu\pi)}\]
or by its limiting value:
\[Y_\nu(z) =
\left.\frac{1}{\pi}\frac{\partial{J_\nu(z)}}{\partial\nu}\right|_{\nu=n} +\quad
\left.\frac{(-1)^n}{\pi}\frac{\partial{J_\nu(z)}}{\partial \nu}\right|_{\nu=-n}. \]
It is sometimes known as Weber's function.

The Hankel functions are alternative solutions of the Bessel equation
distinguished by their asymptotic behaviour as $z\rightarrow \infty$:
\begin{eqnarray*}
H_\nu^{(1)}(z) & \sim & \sqrt{\frac{2}{\pi z}}\exp\left(i\left(z-\frac{\nu\pi}
{2}-\frac{\pi}{4}\right)\right),\\
H_\nu^{(2)}(z) & \sim & \sqrt{\frac{2}{\pi z}}\exp\left(-i\left(z-\frac{\nu\pi}
{2}-\frac{\pi}{4}\right)\right).
\end{eqnarray*}

The modified Bessel functions $I_\nu(z)$ and $K_\nu(z)$ are solutions of the
modified Bessel equation:
\[z^2\frac{\mathrm{d}^2w}{\mathrm{d}z^2}+z\frac{\mathrm{d}w}{\mathrm{d}z} -
(z^2 + \nu^2)w = 0\,.\]
Since they may be obtained by replacing $z$ by $\pm i z$ the modified Bessel
functions are sometimes called \emph{Bessel functions  of imaginary argument}.
$I_\nu(z)$ has the series expansion:
\[I_\nu(z) = \left(\frac{z}{2}\right)^\nu \sum_{k=0}^\infty \frac{(z/2)^{2k}}{k!\Gamma(\nu+k+1)}\,,\]
whereas $K_\nu(z)$ is distinguished by its asymptotic behaviour:
\[K_\nu(z) \sim \sqrt{\frac{\pi}{2 z}}e^{-z}\]
as $z\rightarrow \infty$. For more information, see the DLMF:NIST chapters on
\href{https://dlmf.nist.gov/10.2}{Hankel \& Bessel functions} and \href{https://dlmf.nist.gov/10.25}{Modified Bessel functions}.


The following initial transformations are performed:

\begin{itemize}
\item trivial cases or poles of $J$, $Y$, $I$ and $K$ are handled;
\item $J$, $Y$, $I$ and $K$ with negative first argument are transformed to have
positive first argument;
\item $J$ with negative second argument is transformed to have positive second
argument;
\item $Y$ or $K$ with non-integral or complex second argument is transformed
into an expression in $J$ or $I$ respectively;
\item derivatives of $J$, $Y$ and $I$ are carried out;
\item derivatives of $K$ with zero first argument are carried out;
\item derivatives of Hankel functions are carried out.
\end{itemize}
Also, if the \sw{COMPLEX} switch is on and \sw{ROUNDED} is off,
expressions in Hankel functions are rewritten in terms of Bessel functions.

No numerical approximation is provided for the Bessel $K$ function, or
for the Hankel functions for anything other than special cases.  The
algorithms used for the other Bessel functions are generally
implementations of standard ascending series for $J$, $Y$ and $I$,
together with asymptotic series for $J$ and $Y$; usually, the
asymptotic series are tried first, and if the argument is too small
for them to attain the current precision, the standard series are
applied.  An obvious optimization prevents an attempt with the
asymptotic series if it is clear from the outset that it will fail.

There are no rules for the integration of Bessel and Hankel functions.

\subsection{Airy Functions}
\hypertarget{operator:AIRY_AI}{}
\hypertarget{operator:AIRY_AIPRIME}{}
\hypertarget{operator:AIRY_BI}{}
\hypertarget{operator:AIRY_BIPRIME}{}
\hypertarget{AIRYF}{}
\index{Airy functions}
\ttindex{Airy\_Ai}\ttindex{Airy\_Bi}
\ttindex{Airy\_Aiprime}\ttindex{Airy\_Biprime}

Support is provided for the Airy Functions $Ai$ and $Bi$ and for their
derivatives $Ai'$ and $Bi'$.  The relevant operators are
respectively \f{Airy\_Ai}, \f{Airy\_Bi}, \f{Airy\_Aiprime} and
\f{Airy\_Biprime}, which are all unary.

Airy functions are solutions of the differential equation:
\[ \frac{\mathrm{d}^2 w}{\mathrm{d}z^2} = z w.\]

Trivial cases of Airy\_Ai and Airy\_Bi and their primes are evaluated,
and all functions accept both real and complex arguments.

The Airy Functions can also be represented in terms of Bessel
Functions by activating an inactive rule set:
\begin{verbatim}
    let Airy2Bessel_rules;
\end{verbatim}
As a result the \f{Airy\_Ai} function will be evaluated using the formula:
\[
\f{Ai}(z) =  \frac{1}{3} \sqrt{z} \left[I_{-1/3}(\zeta)
- I_{1/3}(\zeta)\right], \text{ where }
 \zeta =  \frac{2}{3} z^{\frac{2}{3}}.
\]
\textbf{Note:} In order to obtain satisfactory approximations
to numerical values both the \sw{COMPLEX} and \sw{ROUNDED} switches
must be on.

The algorithms used for the Airy Functions are implementations of
standard ascending series, together with asymptotic series.  At some
point it is better to use the asymptotic rather than the ascending
series, which is calculated by the program and depends on the given
precision.

There are no rules for the integration of Airy Functions.

\subsection{Hypergeometric and Other Functions}
\hypertarget{operator:KUMMERM}{}
\hypertarget{operator:KUMMERU}{}
\hypertarget{operator:LOMMEL1}{}
\hypertarget{operator:LOMMEL2}{}
\hypertarget{operator:STRUVEH}{}
\hypertarget{operator:STRUVEL}{}
\hypertarget{operator:WHITTAKERM}{}
\hypertarget{operator:WHITTAKERU}{}
\hypertarget{HYPERGEOM}{}
\ttindex{KummerM}\ttindex{KummerU}\ttindex{StruveH}
\ttindex{StruveL}\ttindex{Lommel1}\ttindex{Lommel2}
\ttindex{WhittakerM}\ttindex{WhittakerW}
\index{Kummer functions}\index{Struve functions}\index{Lommel functions}
\index{Whittaker functions}\index{Hypergeometric functions}

This package also provides some support for other functions, in the form
of algebraic simplifications:
\begin{itemize}
\item The Struve \textbf{H} and \textbf{L} functions, through the binary
operators \f{StruveH} and \f{StruveL}, for which manipulations are
provided to handle special cases, simplify to more readily handled
functions where appropriate, and differentiate with respect to the second
argument. These functions with arguments $\nu$ and $x$ are solutions of the
differential equation:
\[\frac{\mathrm{d}^2w}{\mathrm{d}x^2}+\frac{1}{x}\frac{\mathrm{d}w}{\mathrm{d}x}
+\left(1-\frac{\nu^2}{x^2}\right)w
= \frac{(z/2)^{\nu-1}}{\sqrt{\pi}\Gamma(\nu+1/2)}\,.\]
\item The Lommel functions of the first and second kinds, through the
ternary operators \f{Lommel1} and \f{Lommel2} with arguments $\nu$, $\mu$
and $x$ may be considered generalisations of the Struve functions satisfying
the differential equation:
\[\frac{\mathrm{d}^2w}{\mathrm{d}x^2}+\frac{1}{x}\frac{\mathrm{d}w}{\mathrm{d}x}
+\left(1-\frac{\nu^2}{x^2}\right)w = z^{\mu-1}\,.\]
Manipulations are provided to handle special cases and simplify where
appropriate.
\item The Kummer confluent hypergeometric functions M and U (the
hypergeometric ${_1F_1}$ or $\Phi$, and $z^{-a}{_2F_0}$ or $\Psi$,
respectively), represented by the ternary operators \f{KummerM} and \f{KummerU} with
arguments $a$, $b$ and $x$, are solutions of the differential equation:
\[\frac{\mathrm{d}^2w}{\mathrm{d}x^2}+(b-x)\frac{\mathrm{d} w}{\mathrm{d}x}
-a w = 0\,.\]
There are manipulations for special cases and simplifications, derivatives
and, for the M function, numerical approximations for real arguments.
\item The Whittaker M and W functions are variations upon the Kummer
functions, which are represented by the ternary operators \f{WhittakerM} and
\f{WhittakerW} with arguments $\kappa$, $\mu$ and $x$.
They satisfy the Whittaker differential equation:
\[\frac{\mathrm{d}^2W}{\mathrm{d}x^2}+\left(\frac{1-4\mu^2}{4x^2}+
\frac{\kappa}{x} -\frac{1}{4}\right)W =0\,,\]
which is obtained from the Kummer differential equation via the substituions
\[W=e^{z/2}z^{\mu+1/2} w,\qquad \kappa=b/2-a\qquad \mu =(b-1)/2\,.\]
The Whittaker M and W functions with non-numeric arguments are simplified to
expressions involving the Kummer M and U functions respectively.
\end{itemize}

\subsection{The Riemann Zeta Function}
\hypertarget{operator:ZETA}{}
\hypertarget{RIEMZETA}{}
\ttindex{zeta}\index{Riemann Zeta function}\index{Zeta function}
\index{$\zeta$ function}
This is represented by the unary operator \f{Zeta} and defined by the
formula:
\[\zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s}.\]

With \sw{ROUNDED} off, $\zeta(z)$ is evaluated numerically for even
integral arguments in the range $-31 < z < 31$, and for odd integral
arguments in the range $-30 < z < 16$.  Outside this range the values
become a little unwieldy.

Numerical evaluation of $\zeta$ is only carried out if the argument is real.
The algorithms used for $\zeta$ are: for odd integral arguments, an
expression relating $\zeta(n)$ with $\psi^{n-1}(3)$; for even arguments, a
trivial relationship with the Bernoulli numbers; and for other arguments the
approach is either (for larger arguments) to take the first few primes in
the standard over-all-primes expansion, and then continue with the defining
series with natural numbers not divisible by these primes, or (for smaller
arguments) to use a fast-converging series obtained from \cite{BenderOrszag:78}.

There are no rules for differentiation or integration of $\zeta$.

\subsection{Polylogarithm and Related Functions}
\hypertarget{operator:LERCH_PHI}{}
\hypertarget{POLYLOG}{}
\index{Polylogarithm and related functions} \index{Dilog function}
\ttindex{dilog}
The dilogarithm function $Li_2(z)$ is defined by
\[\mathrm{Li}_2(z) \equiv \sum_{n=1}^\infty \frac{z^n}{n^2} =
-\int_0^z \frac{\log(1-t)}{t}\, \mathrm{d}t\]
and represented by the unary function \f{dilog}.

\ttindex{Polylog}
The polylogarithm function $Li_s(z)$ is defined by
\[\mathrm{Li}_s(z) \equiv \sum_{n=1}^\infty \frac{z^n}{n^s} =
\frac{z}{\Gamma(s)} \int_0^\infty \frac{t^{s-1}}{e^t-z}\, \mathrm{d}t.\]
and represented by the binary function \f{Polylog}.
The case $s=2$ is, of course, the dilogarithm function and the special case
when $z=1$ gives the Riemann zeta function $\zeta(s)$. For $s=1$, the
polylogarithm reduces to the elementary function: $-\log(1-t)$.

\ttindex{Lerch\_Phi}
Lerch's transcendent or Lerch Phi function is defined by
\[\Phi(z,s,a) = \sum_{n=0}^\infty \frac{z^n}{(n+a)^s}.\]
It is represented by the ternary function \texttt{Lerch\_Phi(z,s,a)}.
For the special case $a=1$, Lerch's function is related to a polylogarithm:
$z Li_s(z) = \Phi(z,s,1)$.

\subsection{Lambert's W Function}
\hypertarget{LAMBERTW}{}
\index{Lambert's W function}\ttindex{Lambert\_W}

Lambert's function $\omega(x)$, represented by the unary
operator \texttt{Lambert\_W}, is the inverse of the function
$x=we^w$. Therefore it is an important contribution for the solve
package.

For real-valued arguments $\omega(x)$ is only real-valued in the
interval $(-1/e, \infty)$.  In the interval $(-1/e, 0)$, it is double-valued
with a branch point at the point (-1/e, -1) where $\omega'(x)$ is singular.
The positive branch is defined on the interval $(-1/e, \infty)$ where it is
monotonically increasing with $\omega(x) > -1$. The negative branch is defined
on the interval $(-1/e, 0)$ where it is monotonically decreasing with
$\omega(x) < -1$.

Simplification rules for $\omega(x)$ are provided for the special arguments
$0$ and $-1/e$ and for its logarithm, derivative and integral.
A previous rule for its exponential caused problems with power series expansions
about zero and has been deactivated. This does not seem to impact on the SOLVE
package. However, this rule may be reactivated if required by
\begin{verbatim}
      let lambert_exp_rule;
   %  and deactivated again by
      clear lambert_exp_rule;
\end{verbatim}

The function is studied extensively in \cite{HareCorless:92}.
The current implementation will compute values on the principal branch for
all complex numerical arguments  only if the switch \sw{ROUNDED} is ON.
However, since the numerical computations are carried out in
\texttt{complex-rounded} mode, it is also better to turn the switch
\sw{COMPLEX} ON to avoid repeated irritating mode change warnings.

The real positive branch is part of the principal branch and currently there
is no way of computing values on the real negative  branch or indeed any
non-principal values.

\subsection{Spherical and Solid Harmonics}
\hypertarget{operator:SPHERICALHARMONICY}{}
\hypertarget{operator:SOLIDHARMONICY}{}
\hypertarget{SPHSOLH}{}
\index{Spherical and Solid Harmonics}
\ttindex{SolidHarmonicY} \ttindex{SphericalHarmonicY}

The relevant operators are, respectively,\\
\f{SolidHarmonicY} and \f{SphericalHarmonicY}.

The \f{SolidHarmonicY} operator implements the Solid Harmonics
described below. It expects 6 parameter, namely $n$, $m$, $x$, $y$, $z$ and $r2$
and returns a polynomial in $x$, $y$, $z$ and $r2$.

The operator
\f{SphericalHarmonicY} is a special case of \f{SolidHarmonicY}
with the usual definition:

\begin{verbatim}
algebraic procedure SphericalHarmonicY(n,m,theta,phi);
        SolidHarmonicY(n,m,sin(theta)*cos(phi),
                sin(theta)*sin(phi),cos(theta),1)$
\end{verbatim}


Solid Harmonics of order $n$ (Laplace polynomials)
are homogeneous polynomials of degree $n$ in $x$, $y$, $z$
which are solutions of the Laplace equation:-

\begin{verbatim}
       df(P,x,2) + df(P,y,2) + df(P,z,2) = 0.
\end{verbatim}

There are $2n+1$ independent such polynomials for any given $n \geq 0$
and with:-

\begin{verbatim}
       w!0 = z, w!+ = i*(x-i*y)/2, w!- = i*(x+i*y)/2,
\end{verbatim}

they are given by the Fourier integral:-

\begin{verbatim}
 S(n,m,w!-,w!0,w!+) =
       (1/(2*pi)) *
       for u:=-pi:pi integrate(w!0 + w!+ * exp(i*u)
            + w!- * exp(-i*u))^n * exp(i*m*u) * du;
\end{verbatim}

which is obviously zero if $|m| > n$ since then all terms in the
expanded integrand contain the factor $e^{iku}$ with $k \neq 0$.

$S(n,m,x,y,z)$ is proportional to
\begin{verbatim}
     r^n * Legendre(n,m,cos theta) * exp(i*phi)
\end{verbatim}
where $r^2 = x^2 + y^2 + z^2$.

The spherical harmonics are simply the restriction of the solid
harmonics to the surface of the unit sphere and the set of all
spherical harmonics with $n \geq 0, -n \leq m \leq n$ form a complete
orthogonal basis on it, i.e.\ $\langle n,m | n',m' \rangle
= \delta_{n,n'} \delta_{m,m'}$ using $\langle \ldots | \ldots \rangle$
to designate the scalar product of functions over the spherical
surface.

The coefficients of the solid harmonics are normalised in what
follows to yield an orthonormal system of spherical harmonics.

Given their polynomial nature, there are many recursions formulae
for the solid harmonics and any recursion valid for Legendre functions
can be `translated' into solid harmonics. However the direct proof is
usually far simpler using Laplace's definition.

It is also clear that all differentiations of solid harmonics are
trivial, qua polynomials.

Some substantial reduction in the symbolic form would occur if one
maintained throughout the recursions the symbol $r2$ ($r$ cannot occur
as it is not rational in $x,y,z$). Formally the solid harmonics appear
in this guise as more compact polynomials in $x,y,z,r2$.

Only two recursions are needed:-

(i) along the diagonal $(n,n)$;

(ii) along a line of constant $n$: $(m,m),(m+1,m),\ldots,(n,m)$.

Numerically these recursions are stable.

For $m < 0$ one has:-
\[ S(n,m,x,y,z) = (-1)^m S(n,-m,x,-y,z). \]

\subsection{3j symbols and Clebsch-Gordan Coefficients}
\hypertarget{CLEBSCHG}{}
\ttindex{ThreejSymbol}\ttindex{SixjSymbol}
\ttindex{Clebsch\_Gordan}
The operators \f{ThreeJSymbol} and \f{Clebsch\_Gordan} are defined as
in \cite{LandoltBoernstein:68} or \cite{Edmonds:57} and expect as arguments
three lists of values \{$j_i,m_i$\}, e.g.
\begin{verbatim}
ThreeJSymbol({J+1,M},{J,-M},{1,0});
Clebsch_Gordan({2,0},{2,0},{2,0});
\end{verbatim}

\subsection{6j symbols }
The operator \f{SixJSymbol} is defined as
in \cite{LandoltBoernstein:68} or \cite{Edmonds:57} and
expects two lists of values \{$j_1,j_2,j_3$\} and
\{$l_1,l_2,l_3$\} as arguments, e.g.
\begin{verbatim}
SixJSymbol({7,6,3},{2,4,6});
\end{verbatim}

In the current implementation of \f{SixJSymbol} there is only limited
reasoning about the minima and maxima of the summation using
the INEQ package, such that in most
cases the special 6j-symbols (see e.g.\ \cite{LandoltBoernstein:68})
will not be found.

\subsection{Elliptic Functions}
\index{Elliptic functions}
The implementation of the functions in this and the next two subsections have
been substantially revised by Alan Barnes in 2019. This is to bring the
notation more into line with standard (British) texts such as Whittaker
\& Watson \cite{WhittakerWatson:69} and Lawden \cite{Lawden:89} and also to correct
a number of errors and omissions. These changes and additions will be itemised in the relevant
sections below.  New subsections has been added in 2021 to support  Weierstrassian Elliptic
functions, Sigma functions and inverse Jacobi elliptic functions.
While the code for these is being updated, the autoloading
properties of all elliptic functions has been temporarily removed.


\hypertarget{JACEF}{}
\subsubsection{Jacobi Elliptic  Functions}
The following functions have been implemented:
\begin{itemize}
\item The Twelve Jacobi Functions
\item Arithmetic Geometric Mean
\item Descending Landen Transformation
\end{itemize}

\index{Jacobi Elliptic functions}
The following Jacobi functions are available:-
\hypertarget{operator:JACOBISN}{}
\hypertarget{operator:JACOBICN}{}
\hypertarget{operator:JACOBIDN}{}
\hypertarget{operator:Jacobisd}{}
\hypertarget{operator:Jacobind}{}
\hypertarget{operator:Jacobidc}{}
\hypertarget{operator:Jacobinc}{}
\hypertarget{operator:Jacobisc}{}
\hypertarget{operator:Jacobins}{}
\hypertarget{operator:Jacobids}{}
\hypertarget{operator:Jacobics}{}
\ttindex{Jacobisn}\ttindex{Jacobicn}
\ttindex{Jacobidn}\ttindex{Jacobicd}
\ttindex{Jacobisd}\ttindex{Jacobind}
\ttindex{Jacobidc}\ttindex{Jacobinc}
\ttindex{Jacobisc}\ttindex{Jacobins}
\ttindex{Jacobids}\ttindex{Jacobics}
\begin{itemize}
\item jacobisn(u,k)
\item jacobidn(u,k)
\item jacobicn(u,k)
\item jacobicd(u,k)
\item jacobisd(u,k)
\item jacobind(u,k)
\item jacobidc(u,k)
\item jacobinc(u,k)
\item jacobisc(u,k)
\item jacobins(u,k)
\item jacobids(u,k)
\item jacobics(u,k)
\end{itemize}

These differ somewhat from the originals implemented by Lisa Temme in that
the second argument is now the modulus (usually denoted by $k$ in most texts
rather than its square $m$).  The notation for the most part follows  Lawden
\cite{Lawden:89}. The last nine Jacobi functions are related to the three
basic ones: \f{jacobisn(u,k)}, \f{jacobicn(u,k)} and \f{jacobidn(u,k)} and
use Glaisher's notation. For example
\[ \mathrm{ns}(x,k) = \frac{1}{\mathrm{sn}(u,k)}, \qquad
\mathrm{cs}(x,k) = \frac{\mathrm{cn}(u,k)}{\mathrm{sn}(u,k)}, \qquad
\mathrm{cd}(x,k) = \frac{\mathrm{cn}(u,k)}{\mathrm{dn}(u,k)}. \]

Extended rule lists are provided for differentiation of these functions with
respect to either argument, to implement the standard addition formulae,
argument shifts by multiples of the two quarter-periods $K$ and $iK'$ and
finally Jacobi's transformation for a purely imaginary first argument.

Four utility rule lists \texttt{to\_sn}, \texttt{to\_cn}, \texttt{to\_dn} and
\texttt{no\_glaisher} are provided for user convenience. The first
\texttt{to\_sn} replaces occurences of the squares of $\mathrm{cn}$ and
$\mathrm{dn}$ in favour of the square of $\mathrm{sn}$ using the
`Pythagorean' identities. \texttt{to\_cn} and \texttt{to\_dn} apply these
identities to replace squares in favour of $\mathrm{cn}$ and $\mathrm{dn}$
respectively. At most one of these rule sets should be active at any one time
to avoid a potential infinite recursion in the simplification.
The final rule list \texttt{no\_glaisher} replaces all occurences of the
nine subsidiary Jacobi elliptic functions ($\mathrm{ns}$, $\mathrm{sc}$,
$\mathrm{sd}$, \ldots by reciprocals and quotients of the `basic' Jacobi
elliptic functions $\mathrm{sn}$, $\mathrm{cn}$ and $\mathrm{dn}$.

When their arguments are purely numerical, these twelve functions  will be
evaluated numerically if the \sw{rounded} switch is used. For
complex arguments it is also better if the \sw{complex} switch is on.

\subsubsection{Jacobi Amplitude Function}
\hypertarget{operator:JACOBIAM}{}
\ttindex{Jacobiam}
The amplitude of $u$ can be evaluated using the \f{jacobiam(u,k)}
command.  A rule list is provided for differentiation of this
functions with respect to either argument.

\subsubsection{Arithmetic Geometric Mean (AGM)}
A procedure to evaluate the AGM of initial values \(a_0,b_0,c_0\)
exists as \\
\texttt{AGM\_function(\(a_0,b_0,c_0\))} and will return \\
$\{ N, AGM, \{ a_N, \ldots ,a_0\}, \{ b_N, \ldots ,b_0\},
\{c_N, \ldots ,c_0\}\}$,
where $N$ is the number of steps to compute the AGM to the
desired accuracy.

To determine the Elliptic Integrals K($m$), E($m$) we use initial values
\(a_0 = 1\); \(b_0 = \sqrt{1-k^2}\) ; \(c_0 = k\).

This procedure and the following one are primarily intended for use in the
numerical evaluation of the various elliptic functions and integrals rather
than for direct use by users.

\subsubsection{Descending Landen Transformation}
The procedure to evaluate the Descending Landen Transformation of
$\phi$ and $\alpha$ uses the following equations:
\begin{align*}
 (1+\sin \alpha_{n+1})(1+\cos \alpha_n)=2 &\text{ where } \alpha_{n+1}<\alpha_n, \\
  \tan(\phi_{n+1}-\phi_n)=\cos \alpha_n \tan \phi_n & \text{ where } \phi_{n+1}>\phi_n.
\end{align*}
It can be called using \f{landentrans}($\phi_0$, $\alpha_0$)
and will return \\
$\{\{\phi_0, \ldots ,\phi_n\},\{\alpha_0, \ldots ,\alpha_n\}\}$.

\subsection{Elliptic Integrals}
\hypertarget{ELLIPI}{}
\index{Elliptic Integrals}
The following functions have been implemented:

\begin{itemize}
\item Complete \& Incomplete Elliptic Integrals of the First Kind
\item Complete \& Incomplete Elliptic Integrals of the Second Kind
%\item Ellpitic Integrals of the Third Kind
\item Jacobi's Zeta Function
\end{itemize}

These again differ somewhat from the originals implemented by Lisa Temme
as the second argument is now the modulus $k$ rather that its square.
Also in the original implementation  there was some confusion between
Legendre's form and Jacobi's form of the incomplete elliptic integrals of
the second kind; $E(u,k)$ denoted the first in numerical
evaluations and the second in the derivative formulae for the Jacobi
elliptic functions with respect to their second argument.
This confusion was perhaps understandable
as in the literature some authors use the notation $\mathrm{E}(u, k)$ for
the Legendre form and others for Jacobi's form.

To bring the notation more into line with that in the NIST Digital Library of
Mathematical Functions and avoid any possible confusion, $\mathrm{E}(u, k)$ is used for
the Legendre form and $\mathcal{E}(u, k)$ for Jacobi's form.
This differs from the 2019 version of this section which followed Lawden \cite{Lawden:89},
where the notation $\mathrm{D}(\phi, k)$  and $\mathrm{E}(u, k)$ were used for the
Legendre and Jacobi forms respectively.

A number of rule lists have been provided to implement, where appropriate,
derivatives of these functions, addition rules and periodicity and
quasi-periodicity properties and to provide simplifications for special values
of the arguments.

\subsubsection{Elliptic F}
\hypertarget{operator:ELLIPTICF}{}
\ttindex{EllipticF}

The Elliptic F function can be used as \f{EllipticF(phi,k)} and
will return the value of the \emph{Incomplete Elliptic Integral of the
First Kind}:
\[\mathrm{F}(\phi, k)=\int_0^\phi(1-k^2 \sin^2 \theta)^{-1/2} \mathrm{d}\theta.\]

\subsubsection{Elliptic K}
\hypertarget{operator:ELLIPTICK}{}
\ttindex{EllipticK}

The Elliptic K function can be used as \f{EllipticK(k)} and will
return the value of the \emph{Complete Elliptic Integral of the
First Kind}:
\[\mathrm{K}(k)=\mathrm{F}(\pi/2, k) =\int_0^{\pi/2}(1-k^2 \sin^2 \theta)^{-1/2}\mathrm{d}\theta.\]
This is one of the quarter periods of the Jacobi elliptic
functions and is often used in the calculation of other elliptic functions.

The complementary Elliptic K$'$ function can be used as \f{EllipticK!$'$(k)}
and will return the value
\[\mathrm{K}(k')=\mathrm{K}(\sqrt{1-k^2})\]
which is the other quarter-period of the Jacobi elliptic functions.

\subsubsection{Elliptic E}
\hypertarget{operator:ELLIPTICE}{}
\ttindex{EllipticE}

The Elliptic E function comes with either one or two arguments;
used with two arguments as \f{EllipticE(u,k)}
it will return the value of Legendre's form of
the \emph{Incomplete Elliptic Integral of the Second Kind}:
\[\mathrm{E}(\phi, k)=\int_0^\phi \sqrt{1-k^2 \sin^2 \theta} \,\mathrm{d}\theta.\]
 When called with one argument \f{EllipticE(k)} will return the value of the
\emph{Complete Elliptic Integral of the Second Kind}:
\[\mathrm{E}(k)=\mathrm{E}(\pi/2, k) =
\int_0^{\pi/2} \sqrt{1-k^2 \sin^2 \theta} \,\mathrm{d}\theta.\]

The complementary Elliptic E$'$ function can be used as \f{EllipticE!$'$(k)}
and will return the value
\[\mathrm{E}(k') = \mathrm{E}(\sqrt{1-k^2}).\]

\subsubsection{Jacobi E}
\hypertarget{operator:JACOBIE}{}
\ttindex{JacobiE}
The Jacobi E function can be used as  \f{JacobiE(u,k)};
it will return the value of Jacobi's form of
the \emph{Incomplete Elliptic Integral of the Second Kind}:
\[\mathcal{E}(u, k)=\int_0^u \mathrm{dn}^2 (v, k) \,\mathrm{d}v.\]

The relationship between the two forms of incomplete elliptic integrals can
be expressed as
\[\mathcal{E}(u, k) = \mathrm{E}(\mathrm{am}(u), k).\]
Note that
\[\mathrm{E}(k)=\mathcal{E}(\mathrm{K}(k), k)
=\int_0^{\mathrm{K}(k)} \mathrm{dn}^2(v, k) \,\mathrm{d}v.\]

On a GUI that supports calligraphic characters (NB.\ this is now the case with the
CSL GUI), there is no problem and it is rendered as $\mathcal{E}(u,k)$
in accordance with NIST usage.
On non-GUI interfaces the Jacobi E function is rendered as E\_j.

%\subsection{Ellpitic $\Pi$}
%
%The Elliptic $\pi$ function can be used as \f{EllipticPi( )} and
%will return the value of the {\underline {Elliptic Integral of the
%Third Kind}}.
%

\subsubsection{Jacobi's Zeta Function}
\hypertarget{operator:JACOBIZETA}{}
\ttindex{JacobiZeta}\index{Zeta function of Jacobi}

This can be called as \f{JacobiZeta(u,k)} and refers to Jacobi's (elliptic)
Zeta function $\mathrm{Z}(u,k)$ whereas the operator \f{Zeta} will invoke
Riemann's $\zeta$ function.


\subsubsection{Some Numerical Utility Functions}
\hypertarget{operator:nome}{}
\hypertarget{ELLIPNOME}{}
\ttindex{nome} \index{Nome and Related functions}

Five utility functions are provided:
\begin{itemize}
\item \f{nome2mod(q)}
\item \f{nome2mod!$'$(q)}
\item \f{nome2!K(q)}
\item \f{nome2!K!$'$(q)}
\item \f{nome(k)}
\end{itemize}

These are only operative when the switch \sw{rounded} is on and their
argument is numerical. The first pair relate the nome $q$ of the theta
functions with the moduli $k$ and $k'=\sqrt{1-k^2}$ of the associated Jacobi
elliptic functions.

The second pair return the quarter-periods K and K$'$ respectively of
the Jacobi elliptic functions associated with the nome $q$.

Finally, \f{nome(k)} returns the nome $q$ associated with the modulus $k$ of
a Jacobi elliptic function and is essentially the inverse of \f{nome2mod}.

\subsection{Jacobi Theta Functions}
\hypertarget{JACTF}{}
\index{Jacobi Theta functions}
These theta functions differ from those originally defined by Lisa Temme
in a number of respects.
Firstly four separate functions of two arguments are defined:
\hypertarget{operator:ELLIPTICTHETA1}{}
\hypertarget{operator:ELLIPTICTHETA2}{}
\hypertarget{operator:ELLIPTICTHETA3}{}
\hypertarget{operator:ELLIPTICTHETA4}{}
\ttindex{EllipticTheta1} \ttindex{EllipticTheta2}
\ttindex{EllipticTheta3} \ttindex{EllipticTheta4}
\begin{itemize}
\item \f{elliptictheta1(u,tau)} $\qquad \vartheta_1(u, \tau)$
\item \f{elliptictheta2(u,tau)} $\qquad \vartheta_2(u, \tau)$
\item \f{elliptictheta3(u,tau)} $\qquad \vartheta_3(u, \tau)$
\item \f{ellipticthetas(u,tau)} $\qquad \vartheta_4(u, \tau)$
\end{itemize}

rather than a single function with three arguments (with the first argument
taking integer values in the range 1 to 4).
Secondly the periods are $2\pi, 2\pi, \pi$ and $\pi$ respectively
(NOT 4K, 4K, 2K and 2K).
Thirdly the second argument is the modulus $\tau = a+i b$ where $b=\Im\tau>0$
and hence the quasi-period is $\pi\tau$.

The second parameter was previously the nome $q$
where $|q|<1$. As a consequence \f{elliptictheta1} and \f{elliptictheta2} were
multi-valued owing to the appearance of $q^{1/4}$ in their defining expansions.
\f{elliptictheta3} and \f{elliptictheta4} were, however, single-valued
functions of $q$.

Regarded as functions of $\tau$,
\f{elliptictheta1} and \f{elliptictheta2} are single-valued functions. The nome
is given by $q = \exp(i\pi\tau)$  so that the condition $\Im(\tau)>0$ ensures
that $|q| < 1$. Note also  in this case $q^{1/4}$ is interpreted as
$\exp(i\pi\tau/4)$ rather than the principal value of $q^{1/4}$.
Thus, $\tau$, $2+\tau$, $4+\tau$ and $6+\tau$ produce four different values of
both \f{elliptictheta1} and \f{elliptictheta2} although they all correspond to
the same nome $q$.

The four theta functions are defined by their Fourier series:
\begin{eqnarray*}
  \vartheta_1(z,\tau) & = & 2 e^{i\pi\tau/4}\sum_{n=0}^\infty (-1)^nq^{n^2+n} \sin(2n+1)z\\
\vartheta_2(z,\tau) & = & 2 e^{i\pi\tau/4}\sum_{n=0}^\infty q^{n^2+n} \cos(2n+1)z\\
\vartheta_3(z,\tau) & = & 1 +2\sum_{n=1}^\infty q^{n^2} \cos 2n z\\
\vartheta_4(z,\tau) & = & 1 +2\sum_{n=1}^\infty (-1)^n q^{n^2} \cos 2n z.
\end{eqnarray*}

Utilising the periodicity and quasi-periodicity of the theta functions
some generalised shift rules are implemented to shift their first argument
into the base period parallelogram with vertices
\[(\pi/2, \pi\tau/2),\quad (-\pi/2, \pi\tau/2),\quad (-\pi/2, -\pi\tau/2),
\quad (\pi/2, -\pi\tau/2).\]
Together with the relation $\vartheta_1(0,\tau)=0$,  these shift rules serve to
simplify all four theta functions to zero when appropriate.

When the switches \sw{rounded} and \sw{complex} are on and the arguments are
purely numerical and the imaginary part of $\tau$ positive,
the theta functions are evaluated numerically. Note that as $\tau$ is
necessarily complex, the switch \sw{complex} \emph{must} be on.

In what follows $a$ and $b$ will denote the real and imaginary parts of
$\tau$ respectively and so $|q| = \exp(-\pi b)$ and $\arg q =\pi a$.
The series for the theta functions are fairly rapidly convergent
due to the quadratic growth of the exponents of the nome $q$ -- except
for values of $q$ for which $|q|$ is near to 1
(i.e. $b=\Im \tau $ close to zero).
In such cases the direct algorithm would suffer from slow convergence and
rounding errors.
For such values of $|q|$, Jacobi's transformation $\tau'=-1/\tau$ can be
used to produce a smaller value of the nome and so increase the rate of
convergence.
This works very well for real values of $q$, or equivalently for $\tau$ purely
imaginary since $q'= q^{1/b^2}$, but for complex
values the gains are somewhat smaller. The Jacobi transformation produces a
nome $q'$ for which $|q'| =  |q|^{1/(a^2+b^2)}$.

When $\Re q < 0$, the Jacobi transformation is preceded by either the
modular transformation $\tau' = \tau+1$ when $\Im q < 0$, or $\tau' = \tau-1$
when $\Im q > 0$, which both have the effect  of multiplying $q$ by $-1$,
so that the new nome has a non-negative real part and $|a| \leq 1/2$.
Thus the worst case occurs for values of the nome $q$ near to $\pm i$ where
$|q'| \approx |q|^4$.

By using a series of Jacobi transformations preceded, if necessary by
$\tau$-shifts to ensure $|a| <= 1/2$, $|q|$ may be reduced to an acceptable
level. Somewhat arbitrarily these Jacobi's transformations are used
until $b > 0.6$ (i.e.~$|q| < 0.15$). This seems to produce reasonable
behaviour. In practice more than two applications of Jacobi transformations
are rarely necessary.

The previous version of the numerical code returned the principal values
of $\vartheta_1$ and $\vartheta_2$, that is the ones obtained by taking
the principal value of $q^{1/4}$ in their series expansions. The current version replaces
$q^{1/4}$ by $\exp(i\pi\tau/4)$.  If the principal value is required, it is easily obtained
by multiplying by the `correcting' factor $q^{1/4}\exp(-i\pi\tau/4)$.

\textbf{Derivatives of Theta Functions}


\hypertarget{THETAD}{}
\index{Theta function derivatives}
\ttindex{theta1d} \ttindex{theta2d}
\ttindex{theta3d}\ttindex{theta4d}
Four functions are provided:
\begin{itemize}
\item \f{theta1d(u,ord,tau)}
\item \f{theta2d(u,ord,tau)}
\item \f{theta3d(u,ord,tau)}
\item \f{theta4d(u,ord,tau)}
\end{itemize}
These return the $d$th derivatives of the respective theta functions
with respect to their first argument $u$; $\tau$ is as usual the modulus
of the theta function. These functions are only operative when the switches
\sw{ROUNDED} and \sw{COMPLEX} are ON and their arguments are numeric with
$d$ being a positive integer.  They are provided mainly to support the implementation
the Weierstrassian and Sigma functions discussed in the following subsection.

The numeric code simply sums the Fourier series for the required derivatives.
Unlike the theta functions themselves the code does not use the quasi-periodicity nor
modular transformations to speed  up the convergence of the series by reducing the sizes
of $\Im u$ and $|q|$.  In the numerical evaluation of the Weierstrassian and Sigma functions
these functions are only called after the necessary shifts of the argument $u$ and modular
transformations of $\tau$ have been performed. These are much simpler in this context.

Nevertheless they may be used from top level and numerical experiments reveal that the rounding
errors are not significant provided $|q|$ is not near one (say $|q|<0.9$)
and $u$ is real or at least has a relatively small imaginary part.

\subsection{Weierstrass Elliptic \& Sigma Functions}
\index{Weierstrass Elliptic functions}
\index{Sigma functions}
Three main functions of three arguments are defined:
\hypertarget{WEIERSTRASS}{}
\hypertarget{WEIERSTRASSZETA}{}
\hypertarget{SIGMA}{}
\hypertarget{operator:SIGMA}{}
\hypertarget{operator:WEIERSTRASS}{}
\hypertarget{operator:WEIERSTRASSZETA}{}
\ttindex{Weierstrass} \ttindex{WeierstrassZeta}
\ttindex{sigma}
\begin{itemize}
\item  $\wp(u, \omega_1, \omega_3)$ \ --- \ \f{weierstrass(u,omega1,omega3)}
\item $\zeta_w(u, \omega_1, \omega_3)$ \ --- \ \f{weierstrassZeta(u,omega1,omega3)}
\item $\sigma(u, \omega_1, \omega_3)$ \ --- \ \f{sigma(u,omega1,omega3)}
\end{itemize}

The notation used is broadly similar used by Lawden \cite{Lawden:89} which is also used in the
NIST Digital Library of Mathematical Functions \href{https://dlmf.nist.gov/}{DLMF:NIST}. However,
$\zeta_w$ is used for the Weierstrassian Zeta function to distinguish it from the Riemann Zeta
function and the usual symbol $\wp$ is used for the Weierstrassian elliptic function itself.

The two primitive periods of the Weierstrass function are $2\omega_1$ and $2\omega_3$ and these must satisfy
$\Im(\omega_3/\omega_1) \neq 0$. The two periods are normally numbered so that $\tau = \omega_3/\omega_1$ has
a positive imaginary part and hence the nome $q = exp(i\pi\tau)$ satisfies $|q| <1$.

Any linear combination $\Omega_{m,n} = 2m\omega_1 +2n\omega_3$ where $m$ and $n$ are
integers (not both zero) is also a period. The set of all such periods plus the origin form a lattice. In the literature
$-(\omega_1+\omega_3)$ is often denoted by $\omega_2$ and $2\omega_2$ is clearly also a period; this
accounts for the gap in the numbering of primitive periods. The period $\omega_2$ is not used in \REDUCE the rule sets for
the Weierstrassian elliptic and related functions.

The primitive periods are not unique;
indeed any periods $2\Omega_1$ and $2\Omega_3$ defined by the unimodular integer bilinear transformation:
\[\Omega_1 = a\omega_1 + b\omega_3,\qquad\Omega_3 = c\omega_1 + d\omega_3,\qquad\text{ where }ad-bc = 1\]
are also primitive. This fact is very useful in the numerical evaluation of the Weierstrassian and Sigma
functions as a sequence of such transformations may be used to increase the size $\Im \tau$ and so reduce
the size of $|q|$. Thus the Fourier series for the theta functions and their derivatives will converge rapidly.
In theory these transformations may be used to reduce the size of $|q|$ until $\Im \tau \geq \sqrt 3/2$ when
$|q|<0.06$. However, in numerical evaluations in \REDUCE it is sufficient to use these transformations only until
$\Im \tau > 0.7$, i.e.~until $|q| < 0.11$. In practice only two or three iterations are required
and usually very much smaller values of $|q|$ are achieved particularly when $\tau$ is purely imaginary i.e.~$q$ is real.

In the numerical evaluations, if a result is real (or purely imaginary) it may
happen that the result returned has a very small imaginary part
(resp. real part). The ratio of the `deliquent' part to the actual result is
invariably smaller than current PRECISION and is due to rounding. Similarly if
the true result is actually zero the result returned may have a very small
absolute value -- again smaller than the current PRECISION.

The Weierstrassian function is even and has a pole of order 2 at all lattice points.
The Zeta and Sigma functions are only quasi-periodic on the lattice. Zeta is odd and has simple poles of residue
1 at all lattice points. The basic Sigma function $\sigma(u,\omega_1,\omega_3)$ is odd and regular everywhere as is
the function $\vartheta_1(u,\tau)$ to which it is closely related. It has zeros at all lattice points. All three functions
$\wp$, $\zeta_w$ and $\sigma$ are homogenous of degrees -2, -1 and +1 respectively. The functions are related by
\[ \wp(u) = -\zeta_w^\prime(u),\qquad\qquad \zeta_w(u) = \sigma^\prime(u)/\sigma(u),\]
where the lattice parameters have been omitted for conciseness.

Rule sets are provided which implement all the properties such as double periodicity discussed above. For numerical evaluation
the switches \sw{ROUNDED} and \sw{COMPLEX} must both be ON and all three parameters must be numeric. It is not, however,
necessary to ensure $\Im(\omega_3/\omega_1) >0$ as the second and third parameters will be swapped if required.

\textbf{Alternative forms of the Weierstrass Functions}
\hypertarget{WEIERSTRASS1}{}
\hypertarget{WEIERSTRASSZETA1}{}
\hypertarget{operator:WEIERSTRASS1}{}
\hypertarget{operator:WEIERSTRASSZETA1}{}
\ttindex{Weierstrass1} \ttindex{WeierstrassZeta1}

Two commonly used alternative forms of the Weierstrassian functions in which
they are regarded as functions of the lattice invariants $g_2$ and $g_3$
rather than the primitive periods $\omega_1$ and $\omega_3$ are provided:
\begin{itemize}
\item  $\wp(u \mid g_2, g_3)$ \ --- \ \f{weierstrass1(u,g2,g3)}
\item $\zeta_w(u \mid g_2, g_3)$ \ --- \ \f{weierstrassZeta1(u,g2,g3)}.
\end{itemize}
Note that for output they are distinguished from the two discussed above
by separating the first and
second arguments by a vertical bar rather than a comma. The rule for
differentiation of the Weierstrass function is simpler when expressed in
this  alternative:
\[ \wp^\prime(u \mid g_2,g_3)^2 = 4\,\wp(u \mid g_2,g_3)^3
   - g_2\, \wp(u \mid g_2,g_3) -g_3. \]

\textbf{Other Sigma Functions}
\hypertarget{SIGMA1}{}
\hypertarget{operator:SIGMA1}{}
\hypertarget{operator:SIGMA2}{}
\hypertarget{operator:SIGMA3}{}

Three further Sigma functions are also provided:
\index{Sigma functions}
\ttindex{sigma1} \ttindex{sigma2} \ttindex{sigma3}
\begin{itemize}
\item $\sigma_1(u, \omega_1, \omega_3)$ \ --- \ \f{sigma1(u,omega1,omega3)}
\item $\sigma_2(u, \omega_1, \omega_3)$ \ --- \ \f{sigma2(u,omega1,omega3)}
\item $\sigma_3(u, \omega_1, \omega_3)$ \ --- \ \f{sigma3(u,omega1,omega3)}
\end{itemize}
These are all even functions, regular everywhere, homogenous of degree zero and doubly quasi-periodic. They are closely related to the
theta functions $\vartheta_2$, $\vartheta_3$ and $\vartheta_4$ respectively; but \emph{note the difference in numbering}.
For more information on the properties these sigma functions, see Lawden \cite{Lawden:89};
they do not appear in the NIST Digital Library of Mathematical Functions, but are included here for completeness.

\subsubsection{ Quasi-Period Factors \& Lattice Functions}
\hypertarget{ETA}{}
\ttindex{lattice\_e1}\ttindex{lattice\_e2}\ttindex{lattice\_e3}
\ttindex{lattice\_g2}\ttindex{lattice\_g3}\ttindex{lattice\_delta}
\index{Lattice roots}\index{Lattice invariants}\index{Quasi-period factors}

Ten functions are provided:
\begin{itemize}
\item $e_1(\omega_1, \omega_3)$ \ --- \ \f{lattice\_e1(omega1, omega3)};
\item $e_2(\omega_1, \omega_3)$ \ --- \ \f{lattice\_e2(omega1, omega3)};
\item $e_3(\omega_1, \omega_3)$ \ --- \ \f{lattice\_e3(omega1, omega3)};
\item $g_2(\omega_1, \omega_3)$ \ --- \ \f{lattice\_g2(omega1, omega3)};
\item $g_3(\omega_1, \omega_3)$ \ --- \ \f{lattice\_g3(omega1, omega3)};
\item $\Delta(\omega_1, \omega_3)$ \ --- \ \f{lattice\_delta(omega1, omega3)};
\item $\mathrm{G}(\omega_1, \omega_3)$ \ --- \ \f{lattice\_g(omega1, omega3)};
\item $\eta_1(\omega_1, \omega_3)$ \ --- \ \f{eta\_1(omega1, omega3)};
\item $\eta_2(\omega_1, \omega_3)$ \ --- \ \f{eta\_2(omega1, omega3)};
\item $\eta_3(\omega_1, \omega_3)$ \ --- \ \f{eta\_3(omega1, omega3)}.
\end{itemize}

These are operative when the switches \sw{ROUNDED} and \sw{COMPLEX} are ON
and their arguments are numerical. The first three are referred to as lattice
roots and are related to the invariants
$g_2, g_3$, the discriminant $\Delta = g_2^3-27g_3^2$ and a closely related
invariant $\mathrm{G} = g_2^3/(27 g_3^2)$ of the Weierstrassian
elliptic function $\wp$. The lattice roots also appear in the numerical
evaluation of the Weierstrass function. These lattice roots satisfy:
\[e_1+e_2+e_3=0,\qquad g_2=2(e_1^2+e_2^2+e_3^2),\qquad g_3= 4e_1e_2e_3.\]
If the discriminant $\Delta$ vanishes or equivalently if $\mathrm{G} = 1$,
there are at most two distinct lattice roots and the elliptic function
degenerates to an elementary one. The advantage of the invariant
$\mathrm{G}$ is that it is a function of $\tau = \omega_3/\omega_1$ only.

\ttindex{eta\_1}\ttindex{eta\_2}\ttindex{eta\_3}
The remaining three functions \f{eta\_1}, \f{eta\_2} \& \f{eta\_3} appear in
the rules for the quasi-periodicity of the four sigma functions and of the
Weierstrassian Zeta function. They are also used in the numerical
evaluation of these functions when the switches \sw{ROUNDED} and \sw{COMPLEX}
are ON. The quasi-period relations are:
\begin{eqnarray*}
  \zeta_w(u+2\omega_j) & = & \zeta_w(u)+2\eta_j\\
  \sigma(u+2\omega_j) & = & -exp(2\eta_j(u+\omega_j))\sigma(u)\\
  \sigma_k(u+2\omega_j) & = &  exp(2\eta_j(u+\omega_j))\sigma_k(u) \quad\text{  if  }j\neq k\\
  \sigma_j(u+2\omega_j) & = & -exp(2\eta_j(u+\omega_j))\sigma_j(u)\\
  \zeta_w(\omega_j) & = & \eta_j\\
  \sigma_j(\omega_j) & = & 0,
\end{eqnarray*}
where the lattice parameters have been omitted for conciseness and $j,k = 1\ldots 3$.
The quasi-period factors satisfy
\[\eta_1+\eta_2+\eta_3=0,\qquad
   \eta_1\omega_3-\eta_3\omega_1=\eta_2\omega_1-\eta_1\omega_2=\eta_3\omega_2-\eta_2\omega_3=i\pi/2.\]
As well as the scalar-valued functions discussed above in this section,
there are four functions which return a list as their value:
\ttindex{lattice\_roots}\ttindex{lattice\_invariants}
\ttindex{lattice\_generators}\ttindex{quasi\_period\_factors}
\begin{itemize}
\item \f{lattice\_roots(omega1, omega3)} --- returns $\{e_1,\ e_2,\ e_3\}$;
\item \f{lattice\_invariants(omega1, omega3)} --- returns
  $\{g_2,\ g_3,\ \Delta,\ \mathrm{G}\}$;
\item \f{quasi\_period\_factors(omega1, omega3)}
  --- returns $\{\eta_1,\ \eta_2,\ \eta_3\}$;
\item \f{lattice\_generators(g2, g3)}  --- returns $\{\omega_1,\ \omega_3\}$.
\end{itemize}
The first three are actually more efficient than calling the requisite
scalar-valued functions individually and the fourth is used in the numerical
evaluation of the Weierstrass functions regarded as functions of the
invariants. These functions are only useful when the switches \sw{ROUNDED} and
\sw{COMPLEX} are ON and their arguments are all numerical.
Note that the call sequence:
\begin{verbatim}
  lattice_generators(g2,g3);
  lattice_invariants(first ws, second ws);
  {first ws, second ws};
\end{verbatim}
should reproduce the list \{g2, g3\}, perhaps with small rounding errors. The
corresponding sequence with the calls to \f{lattice\_generators} and
\f{lattice\_invariants} interchanged (and g2 \& g3 replaced by w1 \& w3),
in general, will not produce the same pair of lattice generators since the
generators are only defined up to a unimodular bilinear transformation.

For details of the algorithm used to calculate the lattice generators from the
invariants see the DLMF:NIST chapter on
\href{https://dlmf.nist.gov/23.22#ii}{Lattice Calculations}.

\subsubsection{Inverse Elliptic Functions}
\index{Inverse Elliptic functions}
The following inverses of the 12 Jacobi elliptic functions are available:-
\hypertarget{INVELL}{}
\hypertarget{operator:ARCSN}{}
\hypertarget{operator:ARCCN}{}
\hypertarget{operator:ARCDN}{}
\hypertarget{operator:ARCCD}{}
\hypertarget{operator:ARCSD}{}
\hypertarget{operator:ARCND}{}
\hypertarget{operator:ARCDC}{}
\hypertarget{operator:ARCNC}{}
\hypertarget{operator:ARCSC}{}
\hypertarget{operator:ARCNS}{}
\hypertarget{operator:ARCDS}{}
\hypertarget{operator:ARCCS}{}
\ttindex{arcsn}\ttindex{arccn}
\ttindex{arcdn}\ttindex{arccd}
\ttindex{arcsd}\ttindex{arcnd}
\ttindex{arcdc}\ttindex{arcnc}
\ttindex{arcsc}\ttindex{arcns}
\ttindex{arcds}\ttindex{arccs}
\begin{itemize}
\item arcsn(u,k)
\item arcdn(u,k)
\item arccn(u,k)
\item arccd(u,k)
\item arcsd(u,k)
\item arcnd(u,k)
\item arcdc(u,k)
\item arcnc(u,k)
\item arcsc(u,k)
\item arcns(u,k)
\item arcds(u,k)
\item arccs(u,k)
\end{itemize}

Thus, for example,
\begin{verbatim}
   jacobisn(arcsn(x, k), k)   --> x
   jacobisc(arcsc(x, k), k)   --> x
\end{verbatim}

A rule list is provided to simplify these functions for special values of their
arguments such $x=0$, $k=0$ and $k=1$, to implement the inverse function
simplification formulae illustrated immediately above and for differentiation
of these functions with respect to their two arguments.

Note that although $\mathrm{sc}, \mathrm{sd}, \mathrm{cs}$ and $\mathrm{ds}$
are all odd functions of their first argument, the situation is somewhat
different for the principal values of their inverses;  $\mathrm{arcsc}$ and
$\mathrm{arcsd}$ are also odd functions of their first argument, whereas
the functions $\mathrm{arccs}$ and $\mathrm{arcds}$ satisfy:
\[ \mathrm{arccs}(-x, k) = 2\mathrm{K}(k)-\mathrm{arccs}(x, k),\qquad
\mathrm{arcds}(-x, k) = 2\mathrm{K}(k)-\mathrm{arcds}(x, k).\]

This choice means that the range of (real) principal values is
connected, in fact the open interval $(0, 2\mathrm{K}(k))$. c.f.
\[ \mathrm{arctan}(-x) = -\mathrm{arctan}(x),\qquad
  \mathrm{arccot}(-x) = \pi -\mathrm{arccot}(x). \]

When their arguments are purely numerical, these functions  will be evaluated
numerically if the \sw{rounded} switch is ON.  Currently numerical evaluation
is only available when both arguments are real and $|k|<=1$ and when the
result is also real. This neccessitates restictions on the range of acceptable
values of the first parameter $x$ (see the table below). Note that for
$\mathrm{arcdn}$ and $\mathrm{arcnd}$ a zero value of the modulus $k$ is
excluded (since $\mathrm{dn}(x,0) = \mathrm{nd}(x,0) = 1 \quad \forall x$).

As the Jacobi elliptic functions are doubly periodic, the inverse functions
are multi-valued. The numerical value returned is the principal value which
lies in the range  given in the third column of the table below. 
(c.f. the inverse trigonometric functions). Other \emph{real} values of the
inverse functions are indicated in the fourth column of the table below where
$n$ is an arbitrary integer.

\begin{tabular}{llll}
  Fn & Domain & Principal Value $v$ & Other real values\\
$\mathop{\mathrm{arcsn}}$: & $ |x| <=1 $ &
  $-\mathrm{K}(k) <= v <= \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k)+(-1)^nv$ \\
$\mathop{\mathrm{arccn}}$: &  $ |x| <=1 $ &
  $0 <= v <= 2\mathrm{K}(k)$ & 
  $4 n\mathrm{K}(k) \pm v$ \\
$\mathop{\mathrm{arccd}}$: & $ |x| <=1 $ &
  $0 <= v <= 2\mathrm{K}(k)$ &
  $4 n\mathrm{K}(k) \pm v$ \\
$\mathop{\mathrm{arcns}}$: & $ |x| >=1 $ &
  $-\mathrm{K}(k) <= v <= \mathrm{K}(k)$ \& $v \neq 0$ &
  $2 n\mathrm{K}(k)+(-1)^nv$ \\
$\mathop{\mathrm{arcnc}}$: & $ |x| >=1 $ &
  $0 <= v <= 2\mathrm{K}(k)$ \& $v \neq \mathrm{K}(k)$  &
  $4 n\mathrm{K}(k) \pm v$ \\
$\mathop{\mathrm{arcdc}}$: & $ |x| >=1 $ &
  $0 <= v <= 2\mathrm{K}(k)$ \& $v \neq \mathrm{K}(k)$ &
  $4 n\mathrm{K}(k) \pm v$ \\
$\mathop{\mathrm{arcdn}}$: & $ k' <= x <= 1$ &
  $0 <= v <= \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k) \pm v$ \\  
$\mathop{\mathrm{arcnd}}$: & $ 1 <= x <= 1/k'$ &
  $0 <= v <= \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k) \pm v$ \\   
$\mathop{\mathrm{arcds}}$: & $ |x| >= k'$ &
  $0 < v < 2 \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k)+(-1)^nv $ \\  
$\mathop{\mathrm{arcsd}}$: & $  |x| <= 1/k'$ &
  $-\mathrm{K}(k) <= v <= \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k)+(-1)^nv $ \\
$\mathop{\mathrm{arcsc}}$: & $ x \in \mathbb{R}$ &
  $-\mathrm{K}(k) < v < \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k) + v$ \\  
$\mathop{\mathrm{arccs}}$: & $ x \in \mathbb{R}$ &
  $ 0 < v < 2 \mathrm{K}(k)$ &
  $2 n\mathrm{K}(k) + v$ \\
\end{tabular}

The numerical values of the inverse functions are calculated by
expressing them in terms of the symmetric elliptic integral:
\[ R_F(x,y,z)=\int_0^\infty 1/\sqrt{(t-x)(t-y)(t-z)}\,\mathrm{d}t. \]
This is then evaluated using a sequence of quadratic transformations 
which converge rapidly to the elementary hyperbolic integral:
\[R_c(X^2+Y^2,X^2) = R_F(X^2,X^2,X^2+Y^2) = \mathrm{arctanh}
(Y/(X^2+Y^2))/Y.\]
More information on this method due to Carlson in the 1990's
may be found on the DLMF website:
\href{https://dlmf.nist.gov/19.36#ii}{Quadratic Transformations}
and \href{https://dlmf.nist.gov/19.25#v}{Inverse Jacobian
Elliptic Functions}.

\subsection{Stirling Numbers}
\hypertarget{STIRL}{}
\index{Stirling numbers}\ttindex{Stirling1}\ttindex{Stirling2}
The Stirling numbers of the first and second kind are computed
by calling the binary operators \f{Stirling1} and \f{Stirling2}
respectively.

\index{Pochammer symbol}
Stirling numbers of the first kind have the generating function:
\[\sum_{m=0}^n s_n^m x^m  =  (x-n+1)_n\]
where $(x-n+1)_n$ is the \hyperlink{POCH}{Pochhammer symbol}. This provides
a convenient way of calculating these Stirling numbers by
extracting coefficients of the polynomial obtained by evaluating the
Pochhammer symbol.  \REDUCE however uses an explicit summation.

Stirling numbers of the second kind are defined by the formula:
\[S_n^m = \frac{1}{m!} \sum_{k=0}^m (-1)^{m-k} \binom{m}{k} k^n.\]
\REDUCE uses this explicit summation to evaluate Stirling numbers of the
second kind.

\subsection{Constants}
\hypertarget{CONSTS}{}
\ttindex{Euler\_Gamma}\ttindex{Khinchin}\ttindex{Golden\_Ratio}
\ttindex{Catalan}

The following well-known constants are defined in the \REDUCE\ core,
but the code for computing their numerical value when the switch \sw{ROUNDED}
is on is contained in the special function package.
\begin{itemize}
\item \texttt{Euler\_Gamma} : Euler's constant, also available as $-\psi(1)$;
\item \texttt{Catalan} : Catalan's constant;
\item \texttt{Khinchin} : Khinchin's constant, defined in \cite{Khinchin:64}
(which takes a lot of time to compute);
\item \texttt{Golden\_Ratio} : $\displaystyle\frac{1 + \sqrt{5}}{2}$
\end{itemize}


\subsection{Orthogonal Polynomials}
\hypertarget{POLYFN}{}
\index{Orthogonal polynomials}

All the polynomials in this section take two or more parameters; the first is
the degree of the polynomial and the last is its argument. Any remaining
arguments are parameters which in the literature are normally rendered as
subscripts and superscripts. First, the definitions appropriate to all the sets
of orthogonal polynomials in the following subsections are listed.

A set of polynomials $\{p_n(x)\},\, n=0,1,\ldots$
are said to be \emph{orthogonal} on open interval $(a, b)$
(where $a$ and/or $b$ may be infinite) with positive weight function $w(x)$ if
\[\int_a^b p_n(x)p_m(x)w(x) \mathrm{d}x = 0 \qquad \mbox{when}\ m \neq n.\]
This defines each polynomial $p_n(x)$ up to a constant factor $c_n$ which is
usually fixed by normalisation. If these factors are chosen so that
\[h_n=\int_a^b (p_n(x))^2 w(x) \mathrm{d}x = 1\qquad\mbox{i.e.}\
c_n=\sqrt{h_n}\]
then the polynomial set is said to be \emph{orthonormal.}
An alternative normalisation, that is sometimes used, is to set the leading term
of each polynomial $k_n = 1$. The polynomial set is then said to be
\emph{monic}.

In \REDUCE the normalisation is chosen so that the polynomial
sets are orthonormal and hence $k_n \neq 1$ in general. In the subsections below
on each of the polynomial sets, the interval $(a,b)$ over which the polynomials
are orthogonal, the weight function $w(x)$ and the leading coefficient $k_n$ of
the polynomial of degree $n$ are given together with any constraints on any
additional parameters. Also given are what might be called the `first moment'
$\tilde{h}_n$ of the $n$th polynomial defined by:
\[\tilde{h}_n = \int_a^b x  (p_n(x))^2 w(x) \,\mathrm{d}x\]
and the ratio
\[r_n = \frac{\tilde{k}_n}{k_n}\quad\mbox{where}\ p_n(x) =
k_n x^n + \tilde{k}_n x^{n-1} \ldots\]
These quantities may be used in \href{https://dlmf.nist.gov/18.2#iv}
{recurrence relations} when generating the polynomials.

\subsubsection{Legendre Polynomials}
\hypertarget{LEGENDREP}{}
\index{Legendre polynomials}\ttindex{LegendreP}
The function call \texttt{LegendreP(n,x)} will return the $n$th Legendre
polynomial if $n$ is a non-negative integer; otherwise the result will involve
the original operator \texttt{LegendreP} or on graphical interfaces $P_n(x)$
will be output.

\index{Pochhammer symbol}
The interval of definition is $(-1, 1)$, the weight function $w(x)=1$ and,
for the orthonormal case, the leading coefficients are given by
$k_n=2^n (\frac{1}{2})_n/n!$ where $(\frac{1}{2})_n$ is the
\hyperlink{POCH}{Pochhammer symbol}.
Also $\tilde{h}_n = \frac{2}{2 n +1}$ and $r_n =0$.

\subsubsection{Associated Legendre Functions}
The function call \texttt{LegendreP(n,m,x)} will return the $n$th associated
Legendre function if $n$ and $m$ are integers with $0 \leq m \leq n$;
otherwise the result will involve the original operator \texttt{LegendreP} or
on graphical interfaces $P_n^{(m)}(x)$ will be output.

They are defined by
\[P_n^{(m)}(x) = (-1)^m(1-x^2)^{m/2}\frac{\mathrm{d}^m P_n(x)}{\mathrm{d}x^m}\,;\]
it should be noted that they are only polynomials if $m$ is even. Currently
the extension of these functions to negative $n$ and $m$ is not implemented
in \REDUCE.

For fixed $m$ these functions are orthogonal over the interval $(-1, 1)$;
the weight function being $w(x)=1$. However, unlike the polynomials in the rest
of this section, they are \emph{not} orthonormal:
\[\int_{-1}^1 \left(P_n^{(m)}(x)\right)^2 \mathrm{d}x = h_n =
\frac{2(l+m)!}{(2l+1)!(l-m)!}\,.\]

\subsubsection{Chebyshev Polynomials}
\hypertarget{CHEBYSHEVP}{}
\index{Chebysev polynomials} \ttindex{ChebyshevT}
The function call \texttt{ChebyshevT(n,x)} will return the $n$th Chebyshev
polynomial of the first kind if $n$ is a non-negative integer; otherwise the
result will involve the original operator \texttt{ChebyshevT} or on graphical
interfaces $T_n(x)$ will be output.

The interval of definition is $(-1, 1)$, the weight function
$w(x)=(1-x^2)^{-1/2}$ and, for the orthonormal case, the leading
coefficients are given by $k_n= 2^{n-1}\ \mbox{for}\ n>0;\ k_0 =1$. Also
$\tilde{h}_n = \pi/2\ \ \mbox{for}\ n>0;\ \tilde{h}_0 =\pi\,$ and $r_n=0$.

\ttindex{ChebyshevU}
The function call \texttt{ChebyshevU(n,x)} will return the $n$th Chebyshev
polynomial of the second kind if $n$ is a non-negative integer; otherwise the
result will involve the original operator \texttt{ChebyshevU} or on graphical
interfaces $U_n(x)$ will be output.

The interval of definition is $(-1, 1)$, the weight function
$w(x)=(1-x^2)^{-1/2}$ and, for the orthonormal case, the leading
coefficients are given by $k_n= 2^n$, $\tilde{h}_n = \pi/2$ and $r_n=0$.

\subsubsection{Gegenbauer Polynomials}
\hypertarget{GEGENBAUERP}{}
\index{Gegenbauer polynomials} \ttindex{GegenbauerP}
The function call \texttt{GegenbauerP(n,a,x)} will return the Gegenbauer
polynomial of degree $n$ and parameter $a$ if $n$ is a non-negative integer
and $a$ is numerical; otherwise the result will involve the original operator
\texttt{GegenbauerP} or on graphical interfaces $C_n^{(a)}(x)$ will be output.

\index{Pochhammer symbol}
The interval of definition is $(-1, 1)$, the weight function
$w(x)=(1-x^2)^{a-1/2}$ and, for the orthonormal case, the leading
coefficients are given by $k_n= 2^n (a)_n/n!$ where $(a)_n$ is the
\hyperlink{POCH}{Pochhammer symbol}.
The parameter $a$ should satisfy $a >-1/2,\ \ a \neq 0$. Also
\[\tilde{h}_n = \frac{2^{1-2 a}\pi \Gamma(n+2a)}{(n+a)(\Gamma(a))^2n!}\qquad
\mbox{and}\quad r_n=0\,.\]

\subsubsection{Jacobi Polynomials}
\hypertarget{JACOBIP}{}
\index{Jacobi polynomials} \ttindex{JacobiP}
The function call \texttt{JacobiP(n,a,b,x)} will return the Jacobi
polynomial of degree $n$ and parameters $a$ and $b$ if $n$ is a non-negative
integer  and $a$ and $b$ are numerical; otherwise the result will involve
the original operator \texttt{JacobiP} or on graphical interfaces
$P_n^{(a, b)}(x)$ will be output.

\index{Pochhammer symbol}
The interval of definition is $(-1, 1)$, the weight function
$w(x)=(1-x)^a(1+x)^b$ and, for the orthonormal case, the leading
coefficients are given by
\[\tilde{h}_n = \frac{(n+a+b+1)_n}{2^nn!}\]
where $(n+a+b+1)_n$ is the \hyperlink{POCH}{Pochhammer symbol}.
The parameters $a$ and $b$ should satisfy $a >-1,\ \ b > -1$. Also
\begin{eqnarray*}
\tilde{h}_0 & = & 2^{a+b+1}\frac{\Gamma(a+1)\Gamma(b+1)}{\Gamma(a+b+2)}\\
\tilde{h}_n & = & 2^{a+b+1}\frac{\Gamma(n+a+1)\Gamma(n+b+1)}{(2 n +a+b+1)
\Gamma(n+a+b+1)n!}\quad \mbox{for}\ n>0\\
r_n & = & \frac{n(a-b)}{2n+a+b}.
\end{eqnarray*}

The Legendre, Chebyshev and Gegenbauer polynomials are all, in fact, special
cases of the Jacobi polynomials.

\subsubsection{Laguerre Polynomials}
\hypertarget{LAGUERREP}{}
\index{Laguerre polynomials}\ttindex{LaguerreP}
The function call \texttt{LaguerreP(n,x)} will return the $n$th Laguerre
polynomial if $n$ is a non-negative integer; otherwise the result will involve
the original operator \texttt{LaguerreP} or on graphical interfaces $L_n(x)$
will be output.

The interval of definition is $(0, \infty)$, the weight function
$w(x)=e^{-x}$ and, for the orthonormal case, the leading coefficients
are given by $k_n=(-1)^n/n!$, $\tilde{h}_n =1$ and $r_n = -n^2$.

\subsubsection{Generalised Laguerre Polynomials}
\index{Generalised Laguerre polynomials}\index{Sonin polynomials}
If used with three arguments \texttt{LaguerreP(n,a,x)} returns the $n$th
generalised (or associated) Laguerre polynomial if $n$ is a non-negative
integer and $a$ is numeric; otherwise the result will involve the original
operator \texttt{LaguerreP} or on graphical interfaces $L_n^{(a)}(x)$ will be
output. These are more properly called \emph{Sonin polynomials} after their
discoverer N.~Y.~Sonin.

The interval of definition is $(0, \infty)$, the weight function
$w(x)=e^{-x}x^a$ and, for the orthonormal case, the leading coefficients
are given by $k_n=(-1)^n/n!$, $\tilde{h}_n = \Gamma(n+a+1)/n!$ and
$r_n=-n(n+a)$. The parameter $a$ should satisfy $a > -1$.

\subsubsection{Hermite Polynomials}
\hypertarget{HERMITEP}{}
\index{Hermite polynomials}\ttindex{HermiteP}
The function call \texttt{HermiteP(n,x)} will return the $n$th Hermite
polynomial if $n$ is a non-negative integer; otherwise the result will involve
the original operator \texttt{HermiteP} or on graphical interfaces $H_n(x)$
will be output.

The interval of definition is $(-\infty, +\infty)$, the weight function
$w(x)=e^{-x^2}$ and,
for the orthonormal case, the leading coefficients are given by
$k_n=2^n$, $\tilde{h}_n = \sqrt{\pi}2^nn!$ and $r_n=0$.

\subsection{Other Polynomials and Related Numbers}
\index{Other polynomials}

\subsubsection{Fibonacci Polynomials}
\index{Fibonacci polynomials}\ttindex{FibonacciP}
\hypertarget{FIBONACCIP}{}
\texttt{FibonacciP(n,x)} returns the $n$th Fibonacci polynomial
in the variable $x$. If $n$ is an integer, it will be
evaluated using the recursive definition:
\[F_0(x) = 0;\qquad F_1(x) = 1; \qquad F_n(x) = x F_{n-1}(x) + F_{n-2}(x)\,.\]

The recursion is, of course, optimised as a simple loop to avoid repeated
computation of lower-order polynomials.

\subsubsection{Euler Numbers and Polynomials}
\index{Euler polynomials}\index{Euler numbers}
\ttindex{EulerP}\ttindex{Euler}
\hypertarget{EULERP}{}
Euler numbers are computed by the unary operator \f{Euler}; the
call \texttt{Euler(n)} returns the $n$th Euler number; all the odd Euler
numbers are zero. The computation is
derived directly from Pascal's triangle of binomial coefficients.

The Euler numbers and polynomials have the following generating functions:

\[\frac {2e^t} {1+e^{2t}} = \sum_{n=0}^{\infty}\frac{E_nt^n}{n!},\qquad\quad
\frac {e^{x t}} {1+e^t} = \sum_{n=0}^{\infty}\frac{E_n(x)t^n}{n!}\]
respectively.  Thus $E_0=1$ and $E_1=0$. Furthermore the numbers and
polynomials are related by the equations:
\[ E_n = 2^nE_n\left(\frac{1}{2}\right),\qquad\quad
E_n(x) = \sum_{k=0}^n \binom{n}{k} \frac{E_k}{2^k} \left(x-\frac{1}{2}\right)^{n-k}.\]

The Euler polynomials are evaluated for non-negative integer $n$ by using
the summation immediately above.

\subsubsection{Bernoulli Numbers \& Polynomials}
\index{Bernoulli polynomials}\index{Bernoulli numbers}
\ttindex{BernoulliP}\ttindex{Bernoulli}
\hypertarget{BERNOULLIP}{}
The call \texttt{Bernoulli(n)}
evaluates to the $n$th Bernoulli number;
all of the odd Bernoulli numbers, except \texttt{Bernoulli(1)}, are
zero.

The algorithms for Bernoulli numbers used are based upon those by Herbert Wilf,
presented by Sandra Fillebrown \cite{Fillebrown:92}.
If the \sw{ROUNDED} switch is off,
the algorithms are exactly those; if it is on, some further rounding may
be done to prevent computation of redundant digits.  Hence, these
functions are particularly fast when used to approximate the Bernoulli
numbers in rounded mode.

The Bernoulli numbers and polynomials have the following generating functions:
\[ \frac {t} {e^t-1} = \sum_{n=0}^{\infty}\frac{B_nt^n}{n!},\qquad\quad
\frac {te^{x t}} {e^t -1} = \sum_{n=0}^{\infty}\frac{B_n(x)t^n}{n!}\]
respectively. Thus $B_0=1$ and $B_1=-\frac{1}{2}$. Furthermore the numbers and
polynomials are related by the equations:
\[ B_n= B_n(0),\qquad\quad  B_n(x) = \sum_{k=0}^n \binom{n}{k} B_kx^{n-k}.\]

The Bernoulli polynomials are evaluated for non-negative integer $n$ by using
the summation immediately above.

Both the Bernoulli and Euler numbers and polynomials may also be calculated
directly by expanding the corresponding generating function as a power
series in $t$ using either the TPS or TAYLOR package, extracting the $n$th term
and multiplying by $n!$. The use of the TPS package is probably preferable here
as the series for the generating function is extendible and need only be
calculated once; it will be extended automatically if higher order numbers or
polynomials are required.

\subsection{Acknowledgements}

The contributions of Kerry Gaskell, Matthew Rebbeck, Lisa Temme,
Stephen Scowcroft and David Hobbs (all students from the University of Bath
on placement in ZIB Berlin for one year) were very helpful
to augment the package. The advice of Ren\'e Grognard (CSIRO, Australia)
for the development of the module for Clebsch-Gordan and 3j, 6j symbols
and the module for spherical and solid harmonics was very much appreciated.
\newpage

\subsection{Tables of Operators and Constants}
\hypertarget{SPECFNTAB1}{}

\textbf{Special Functions}

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
$\mathrm{Si}(z)$ & \f{Si(z)}\\
$\mathrm{Si}(z)-\pi/2$ & \f{s\_i(z)}\\
$\mathrm{Ci}(z)$ & \f{Ci(z)}\\
$\mathrm{Shi}(z)$ & \f{Shi(z)}\\
$\mathrm{Chi}(z)$ & \f{Chi(z)}\\
$\mathrm{erf}(z)$ & \f{Erf(z)}\\
$1-\mathrm{erf}(z)$ & \f{erfc(z)}\\
$\mathrm{Ei}(z)$ & \f{Ei(z)}\\
$\mathrm{Ei}(\log(z))$ & \f{Li(z)}\\
$C(x)$ & \f{Fresnel\_C(x)}\\
$S(x)$ & \f{Fresnel\_S(x)}\\[5pt]
$B(a,b)$ & \f{Beta(a,b)}\\
$\Gamma(a)$ & \f{Gamma(a)}\\
normalized incomplete Beta $I_{x}(a,b)=\frac{\textstyle B_{x}(a,b)}{\textstyle B(a,b)}$ & \f{iBeta(a,b,x)}\\ % http://dlmf.nist.gov/8.2.E4
normalized incomplete Gamma $P(a,z)=\frac{\textstyle\gamma(a,z)}{\textstyle\Gamma(a)}$ & \f{iGamma(a,z)}\\
incomplete Gamma $\gamma(a,z)$ & \f{m\_gamma(a,z)}\\
$(a)_k$ & \f{Pochhammer(a,k)}\\
$\psi(z)$ & \f{Psi(z)}\\
$\psi^{(n)}(z)$ & \f{Polygamma(n,z)}\\[5pt]
$J_\nu(z)$ & \f{BesselJ(nu,z)}\\
$Y_\nu(z)$ & \f{BesselY(nu,z)}\\
$I_\nu(z)$ & \f{BesselI(nu,z)}\\
$K_\nu(z)$ & \f{BesselK(nu,z)}\\
$H^{(1)}_n(z)$ & \f{Hankel1(n,z)}\\
$H^{(2)}_n(z)$ & \f{Hankel2(n,z)}\\[5pt]
\end{tabular}}
\newpage

\textbf{More Special Functions}
\hypertarget{SPECFNTAB2}{}

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
$\mathrm{Ai}(z)$ & \f{Airy\_Ai(z)}\\
$\mathrm{Bi}(z)$ & \f{Airy\_Bi(z)}\\
$\mathrm{Ai}'(z)$ & \f{Airy\_Aiprime(z)}\\
$\mathrm{Bi}'(z)$ & \f{Airy\_Biprime(z)}\\
${\bf H}_{\nu}(z)$ & \f{StruveH(nu,z)}\\
${\bf L}_{\nu}(z)$ & \f{StruveL(nu,z)}\\
$s_{a,b}(z)$ & \f{Lommel1(a,b,z)}\\
$S_{a,b}(z)$ & \f{Lommel2(a,b,z)}\\
$M(a, b, z)$ or $_1F_1(a, b; z)$ or $\Phi(a, b; z)$ &
\f{KummerM(a,b,z)}\\
$U(a, b, z)$ or $z^{-a}{_2F_0(a, b; z)}$ or $\Psi(a, b; z)$ &
\f{KummerU(a,b,z)}\\[6pt]
Expression in Kummer\_M & \f{WhittakerM(kappa,mu,z)}\\
Expression in Kummer\_U & \f{WhittakerW(kappa,mu,z)}\\
Riemann's $\zeta(z)$ & \f{zeta(z)}\\
Lambert $\omega(z)$ & \f{Lambert\_W(z)}\\
$\mathrm{Li}_2(z)$ & \f{dilog(z)}\\
$\mathrm{Li}_{n}(z)$ & \f{Polylog(n,z)}\\
Lerch's transcendent $\Phi(z,s,a)$ & \f{Lerch\_Phi(z,s,a)}\\[5pt]
\end{tabular}}

%% Nested tabular environments need special treatment to work with MathJax:
\ifdefined\VerbMath
\(
\newcommand{\ThreeJSymbol}{\begin{pmatrix} j_{1} & j_{2} & j_{3} \\ m_{1} & m_{2} & m_{3} \end{pmatrix}}
\newcommand{\SixJSymbol}{\begin{Bmatrix} j_{1} & j_{2} & j_{3} \\ m_{1} & m_{2} & m_{3} \end{Bmatrix}}
\)%
\else
\newcommand{\ThreeJSymbol}{\begin{pmatrix} j_{1} & j_{2} & j_{3} \\ m_{1} & m_{2} & m_{3} \end{pmatrix}}
\newcommand{\SixJSymbol}{\begin{Bmatrix} j_{1} & j_{2} & j_{3} \\ m_{1} & m_{2} & m_{3} \end{Bmatrix}}
\fi

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
$Y_n^{m}(x,y,z,r2)$ & \f{SolidHarmonicY(n,m,x,y,z,r2)}\\
$Y_n^{m}(\theta,\phi)$ & \f{SphericalHarmonicY(n,m,theta,phi)}\\[5pt]
$\displaystyle\ThreeJSymbol$ & \f{ThreeJSymbol(\{j1,m1\},\{j2,m2\},\{j3,m3\})}\\[4mm]
$( j_1m_1j_2m_2 \mid j_1j_2j_3 - m_3 )$ & \f{Clebsch\_Gordan(\{j1,m1\},\{j2,m2\},\{j3,m3\})}\\[4mm]
$\displaystyle\SixJSymbol$ & \f{SixJSymbol(\{j1,j2,j3\},\{l1,l2,l3\})}\\[5pt]
\end{tabular}}
\newpage

\textbf{Elliptic Functions and Integrals}
\hypertarget{SPECFNTAB3}{}

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
$\mathrm{am}(u,k)$ & \f{jacobiam(u,k)}\\
$\mathrm{sn}(u,k)$ & \f{jacobisn(u,k)}\\
$\mathrm{dn}(u,k)$ & \f{jacobidn(u,k)}\\
$\mathrm{cn}(u,k)$ & \f{jacobicn(u,k)}\\
$\mathrm{cd}(u,k)$ & \f{jacobicd(u,k)}\\
$\mathrm{sd}(u,k)$ & \f{jacobisd(u,k)}\\
$\mathrm{nd}(u,k)$ & \f{jacobind(u,k)}\\
$\mathrm{dc}(u,k)$ & \f{jacobidc(u,k)}\\
$\mathrm{nc}(u,k)$ & \f{jacobinc(u,k)}\\
$\mathrm{sc}(u,k)$ & \f{jacobisc(u,k)}\\
$\mathrm{ns}(u,k)$ & \f{jacobins(u,k)}\\
$\mathrm{ds}(u,k)$ & \f{jacobids(u,k)}\\
$\mathrm{cs}(u,k)$ & \f{jacobics(u,k)}\\
Inverse Functions of the above:\\
$\mathrm{arcsn}(u,k)$ & \f{arcsn(u,k)}\\
$\mathrm{arccn}(u,k)$ & \f{arccn(u,k)}\\
   ... \\
$\mathrm{arccs}(u,k)$ & \f{arccs(u,k)}\\

Complete Integral (1st kind) $\mathrm{K}(k)$ & \f{ellipticK(k)}\\
$\mathrm{K}^\prime(k)$ & \f{ellipticK!'(k)}\\
Incomplete Integral (1st kind) $\mathrm{F}(\phi,k)$ & \f{ellipticF(phi,k)}\\
Complete Integral (2nd kind) $\mathrm{E}(k)$ & \f{ellipticE(k)}\\
$\mathrm{E}^\prime(k)$ & \f{ellipticE!'(k)}\\
Legendre Incomplete Int (2nd kind) $\mathrm{E}(u,k)$ & \f{ellipticE(u,k)}\\
Jacobi Incomplete Int (2nd kind) $\mathcal{E}(u,k)$ & \f{JacobiE(u,k)}\\
Jacobi's Zeta $\mathrm{Z}(u,k)$ & \f{jacobizeta(u,k)}\\
$\vartheta_1(u,\tau)$ & \f{elliptictheta1(u,tau)}\\
$\vartheta_2(u,\tau)$ & \f{elliptictheta2(u,tau)}\\
$\vartheta_3(u,\tau)$ & \f{elliptictheta3(u,tau)}\\
$\vartheta_4(u,\tau)$ & \f{elliptictheta4(u,tau)}\\
$\wp(u,\omega_1, \omega_3)$ & \f{weierstrass(u,omega1,omega3)}\\
$\zeta_w(u,\omega_1, \omega_3)$ & \f{weierstrasszeta(u,omega1,omega3)}\\
$\sigma(u,\omega_1, \omega_3)$ & \f{sigma(u,omega1,omega3)}\\
$\sigma_1(u,\omega_1, \omega_3)$ & \f{sigma1(u,omega1,omega3)}\\
$\sigma_2(u,\omega_1, \omega_3)$ & \f{sigma2(u,omega1,omega3)}\\
$\sigma_3(u,\omega_1, \omega_3)$ & \f{sigma3(u,omega1,omega3)}\\
$\wp(u \mid g_2, g_3)$ & \f{weierstrass1(u,g2,g3)}\\
$\zeta_w(u \mid g_2, g_3)$ & \f{weierstrasszeta1(u,g2,g3)}\\[5pt]
\end{tabular}}
\newpage

\textbf{Polynomial Functions}
\hypertarget{SPECFNTAB4}{}

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
Fibonacci Polynomials $F_{n}(x)$ &  \f{FibonacciP(n,x)}\\
$B_n(x)$ & \f{BernoulliP(n,x)}\\
$E_n(x)$ & \f{EulerP(n,x)}\\
$H_n(x)$ & \f{HermiteP(n,x)}\\
$L_n(x)$ & \f{LaguerreP(n,x)}\\
Generalised Laguerre $L_n^{(m)}(x)$ & \f{LaguerreP(n,m,x)}\\
$P_n(x)$ & \f{LegendreP(n,x)}\\
Associated Legendre $P_n^{(m)}(x)$ & \f{LegendreP(n,m,x)}\\
$U_n(x)$ & \f{ChebyshevU(n,x)}\\
$T_n(x)$ & \f{ChebyshevT(n,x)}\\
$C_n^{(\alpha)}(x)$ & \f{GegenbauerP(n,alpha,x)}\\
$P_n^{(\alpha,\beta)} (x)$ & \f{JacobiP(n,alpha,beta,x)}\\[5pt]
\end{tabular}}

\vspace{1cm}

\textbf{Well-known Numbers and Reserved Constants}
\hypertarget{SPECFNTAB5}{}

\fbox{
\begin{tabular}{r l}
\rule{0pt}{16pt}Function & Operator\\[5pt]
$\displaystyle\binom{n}{m}$ & \f{Binomial(n,m)}\\[10pt]
Fibonacci Numbers $F_{n}$ & \f{Fibonacci(n)}\\
$\mathrm{s}_n^m$ & \f{Stirling1(n,m)}\\
$\mathrm{S}_n^m$ & \f{Stirling2(n,m)}\\
Bernoulli($n$) or $ B_n $ & \f{Bernoulli(n)}\\
Euler($n$) or $ E_n $ & \f{Euler(n)}\\
Motzkin($n$) or $ M_n $ & \f{Motzkin($n$)}\\
\\
Constant & \REDUCE name\\[5pt]
Square root of $(-1)$ & \f{i}\\
$\pi$ &  \f{pi}\\
Base of natural logarithms & \f{e}\\
Euler's $\gamma$ constant & \f{Euler\_gamma}\\
Catalan's constant & \f{Catalan}\\
Khinchin's constant & \f{Khinchin}\\
Golden ratio & \f{Golden\_ratio}\\[5pt]
\end{tabular}}
